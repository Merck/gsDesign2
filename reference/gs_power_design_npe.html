<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Group sequential design computation with non-constant effect and information. — gs_design_npe • gsDesign2</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Group sequential design computation with non-constant effect and information. — gs_design_npe"><meta name="description" content="The following two functions allow a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
They require treatment effect and statistical information at each analysis
as well as a method of deriving bounds, such as spending.
Initial bound types supported are spending bounds and fixed bounds.
These routines enables two things not available in the gsDesign package: 1)
non-constant effect, 2) more flexibility in boundary selection.
gs_power_npe() derives group sequential bounds and boundary crossing probabilities
for a design, given treatment effect and information at each analysis and the
method of deriving bounds, such as spending.
gs_design_npe() derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses, as well as the
method of deriving bounds, such as spending.
The only differences in arguments between the two functions are the alpha and beta
parameters used in the gs_design_npe()."><meta property="og:description" content="The following two functions allow a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
They require treatment effect and statistical information at each analysis
as well as a method of deriving bounds, such as spending.
Initial bound types supported are spending bounds and fixed bounds.
These routines enables two things not available in the gsDesign package: 1)
non-constant effect, 2) more flexibility in boundary selection.
gs_power_npe() derives group sequential bounds and boundary crossing probabilities
for a design, given treatment effect and information at each analysis and the
method of deriving bounds, such as spending.
gs_design_npe() derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses, as well as the
method of deriving bounds, such as spending.
The only differences in arguments between the two functions are the alpha and beta
parameters used in the gs_design_npe()."><meta property="og:image" content="https://merck.github.io/gsDesign2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gsDesign2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Merck/gsDesign2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Group sequential design computation with non-constant effect and information.</h1>
      <small class="dont-index">Source: <a href="https://github.com/Merck/gsDesign2/blob/main/R/gs_design_npe.R" class="external-link"><code>R/gs_design_npe.R</code></a>, <a href="https://github.com/Merck/gsDesign2/blob/main/R/gs_power_npe.R" class="external-link"><code>R/gs_power_npe.R</code></a></small>
      <div class="d-none name"><code>gs_power_design_npe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The following two functions allow a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
They require treatment effect and statistical information at each analysis
as well as a method of deriving bounds, such as spending.
Initial bound types supported are spending bounds and fixed bounds.
These routines enables two things not available in the gsDesign package: 1)
non-constant effect, 2) more flexibility in boundary selection.</p>
<p><code>gs_power_npe()</code> derives group sequential bounds and boundary crossing probabilities
for a design, given treatment effect and information at each analysis and the
method of deriving bounds, such as spending.</p>
<p><code>gs_design_npe()</code> derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses, as well as the
method of deriving bounds, such as spending.</p>
<p>The only differences in arguments between the two functions are the <code>alpha</code> and <code>beta</code>
parameters used in the <code>gs_design_npe()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gs_design_npe</span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  theta1 <span class="op">=</span> <span class="va">theta</span>,</span>
<span>  info <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  info0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h0_h1_info"</span>, <span class="st">"h0_info"</span>, <span class="st">"h1_info"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gs_power_npe</span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  theta1 <span class="op">=</span> <span class="va">theta</span>,</span>
<span>  info <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  info0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h0_h1_info"</span>, <span class="st">"h0_info"</span>, <span class="st">"h1_info"</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Natural parameter for group sequential design representing
expected cumulative drift at all analyses; used for power calculation.
It can be a scalar (constant treatment effect) or a vector (non-constant treatment effect).
The user must provide a value for <code>theta</code>.</p></dd>


<dt id="arg-theta-">theta0<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>Natural parameter for null hypothesis.
It can be a scalar (constant treatment effect) or a vector (non-constant treatment effect).
The default is 0. If a value other than 0 is provided, it affects upper bound computation.</p></dd>


<dt id="arg-theta-">theta1<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>Natural parameter for alternate hypothesis,
if needed for lower bound computation.
It can be a scalar (constant treatment effect) or a vector (non-constant treatment effect).
The default is the same as <code>theta</code>, which yields the usual beta-spending.
If set to 0, spending is 2-sided under the null hypothesis.</p></dd>


<dt id="arg-info">info<a class="anchor" aria-label="anchor" href="#arg-info"></a></dt>
<dd><p>Statistical information at all analyses for input <code>theta</code>.
It is a vector of positive numbers in increasing order.
The user must provide values corresponding to <code>theta</code>.</p></dd>


<dt id="arg-info-">info0<a class="anchor" aria-label="anchor" href="#arg-info-"></a></dt>
<dd><p>Statistical information under null hypothesis.
It is a vector of all positive numbers with increasing order.
Default is set to be the same as <code>info</code>.
If <code>info0</code> is different than <code>info</code>, it impacts null hypothesis bound calculation.</p></dd>


<dt id="arg-info-">info1<a class="anchor" aria-label="anchor" href="#arg-info-"></a></dt>
<dd><p>Statistical information under hypothesis used for futility bound calculation.
It is a vector of all positive numbers with increasing order.
Default is set to be the same as <code>info</code>.
If <code>info1</code> is different from <code>info</code>, it impacts futility bound calculation.</p></dd>


<dt id="arg-info-scale">info_scale<a class="anchor" aria-label="anchor" href="#arg-info-scale"></a></dt>
<dd><p>Information scale for calculation. Options are:</p><ul><li><p><code>"h0_h1_info"</code> (default): variance under both null and alternative hypotheses is used.</p></li>
<li><p><code>"h0_info"</code>: variance under null hypothesis is used.
This is often used for testing methods that use local alternatives, such as the Schoenfeld method.</p></li>
<li><p><code>"h1_info"</code>: variance under alternative hypothesis is used.</p></li>
</ul></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>One-sided Type I error.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Type II error.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Function to compute upper bound.</p><ul><li><p><code><a href="gs_spending_bound.html">gs_spending_bound()</a></code>: alpha-spending efficacy bounds.</p></li>
<li><p><code><a href="gs_b.html">gs_b()</a></code>: fixed efficacy bounds.</p></li>
</ul></dd>


<dt id="arg-upar">upar<a class="anchor" aria-label="anchor" href="#arg-upar"></a></dt>
<dd><p>Parameters passed to <code>upper</code>.</p><ul><li><p>If <code>upper = gs_b</code>, then <code>upar</code> is a numerical vector specifying the fixed efficacy bounds per analysis.</p></li>
<li><p>If <code>upper = gs_spending_bound</code>, then <code>upar</code> is a list including</p><ul><li><p><code>sf</code> for the spending function family.</p></li>
<li><p><code>total_spend</code> for total alpha spend.</p></li>
<li><p><code>param</code> for the parameter of the spending function.</p></li>
<li><p><code>timing</code> specifies spending time if different from information-based spending; see details.</p></li>
</ul></li>
</ul></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Function to compute lower bound, which can be set up similarly as <code>upper</code>.
See <a href="https://merck.github.io/gsDesign2/articles/story-seven-test-types.html">this vignette</a>.</p></dd>


<dt id="arg-lpar">lpar<a class="anchor" aria-label="anchor" href="#arg-lpar"></a></dt>
<dd><p>Parameters passed to <code>lower</code>, which can be set up similarly as <code>upar.</code></p></dd>


<dt id="arg-test-upper">test_upper<a class="anchor" aria-label="anchor" href="#arg-test-upper"></a></dt>
<dd><p>Indicator of which analyses should include
an upper (efficacy) bound;
single value of <code>TRUE</code> (default) indicates all analyses; otherwise,
a logical vector of the same length as <code>info</code> should
indicate which analyses will have an efficacy bound.</p></dd>


<dt id="arg-test-lower">test_lower<a class="anchor" aria-label="anchor" href="#arg-test-lower"></a></dt>
<dd><p>Indicator of which analyses should include a lower bound;
single value of <code>TRUE</code> (default) indicates all analyses;
single value of <code>FALSE</code> indicated no lower bound; otherwise,
a logical vector of the same length as <code>info</code> should
indicate which analyses will have a lower bound.</p></dd>


<dt id="arg-binding">binding<a class="anchor" aria-label="anchor" href="#arg-binding"></a></dt>
<dd><p>Indicator of whether futility bound is binding;
default of <code>FALSE</code> is recommended.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Integer value controlling grid for numerical integration as in
Jennison and Turnbull (2000); default is 18, range is 1 to 80.
Larger values provide larger number of grid points and greater accuracy.
Normally, <code>r</code> will not be changed by the user.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Tolerance parameter for boundary convergence (on Z-scale); normally not changed by the user.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with columns of</p><ul><li><p><code>analysis</code>: analysis index.</p></li>
<li><p><code>bound</code>: either of value <code>"upper"</code> or <code>"lower"</code>, indicating the upper and lower bound.</p></li>
<li><p><code>z</code>: the Z-score bounds.</p></li>
<li><p><code>probability</code>: cumulative probability of crossing the bound at or before the analysis.</p></li>
<li><p><code>theta</code>: same as the input.</p></li>
<li><p><code>theta1</code>: same as the input.</p></li>
<li><p><code>info</code>: statistical information at each analysis.</p><ul><li><p>If it is returned by <code>gs_power_npe</code>, the <code>info</code>, <code>info0</code>, <code>info1</code> are same as the input.</p></li>
<li><p>If it is returned by <code>gs_design_npe</code>, the <code>info</code>, <code>info0</code>, <code>info1</code> are changed by a constant scale factor.
factor to ensure the design has power <code>1 - beta</code>.</p></li>
</ul></li>
<li><p><code>info0</code>: statistical information under the null at each analysis.</p></li>
<li><p><code>info1</code>: statistical information under the alternative at each analysis.</p></li>
<li><p><code>info_frac</code>: information fraction at each analysis, i.e., <code>info / max(info)</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The bound specifications (<code>upper</code>, <code>lower</code>, <code>upar</code>, <code>lpar</code>) of <code>gs_design_npe()</code>
will be used to ensure Type I error and other boundary properties are as specified.
See the help file of <code><a href="gs_spending_bound.html">gs_spending_bound()</a></code> for details on spending function.</p>
    </div>
    <div class="section level2">
    <h2 id="specification">Specification<a class="anchor" aria-label="anchor" href="#specification"></a></h2>


<p>The contents of this section are shown in PDF user manual only.</p>

<p>The contents of this section are shown in PDF user manual only.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Keaven Anderson <a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/" class="external-link">gsDesign</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_design_npe with single analysis</span></span></span>
<span class="r-in"><span><span class="co"># Lachin book p 71 difference of proportions example</span></span></span>
<span class="r-in"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fl">.28</span> <span class="co"># Control response rate</span></span></span>
<span class="r-in"><span><span class="va">pe</span> <span class="op">&lt;-</span> <span class="fl">.40</span> <span class="co"># Experimental response rate</span></span></span>
<span class="r-in"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pc</span> <span class="op">+</span> <span class="va">pe</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="co"># Ave response rate under H0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Information per increment of 1 in sample size</span></span></span>
<span class="r-in"><span><span class="va">info0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">p0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">pc</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pc</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pe</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Result should round up to next even number = 652</span></span></span>
<span class="r-in"><span><span class="co"># Divide information needed under H1 by information per patient added</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span>theta <span class="op">=</span> <span class="va">pe</span> <span class="op">-</span> <span class="va">pc</span>, info <span class="op">=</span> <span class="va">info</span>, info0 <span class="op">=</span> <span class="va">info0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability probability0 theta  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  1.96         0.9        0.025  0.12  737.  725.  737.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info_frac &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_design_npe with with fixed bound</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.0125</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, sfu <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, alpha <span class="op">=</span> <span class="fl">0.0125</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  4.17    0.000<span style="text-decoration: underline;">278</span>    0.000<span style="text-decoration: underline;">015</span>2   0.1     0.333  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">1</span>       0.042<span style="text-decoration: underline;">9</span>      0.159       0.1     0.333  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.85    0.208       0.002<span style="text-decoration: underline;">22</span>     0.2     0.667 103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower  0       0.053<span style="text-decoration: underline;">7</span>      0.513       0.2     0.667 103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  2.26    0.900       0.012<span style="text-decoration: underline;">5</span>      0.3     1     155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  0       0.053<span style="text-decoration: underline;">7</span>      0.606       0.3     1     155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same upper bound; this represents non-binding Type I error and will total 0.025</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">info</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper    4.17   0.000<span style="text-decoration: underline;">015</span>2     0      0     0.333  51.6  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper    2.85   0.002<span style="text-decoration: underline;">22</span>       0      0     0.667 103.  103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper    2.26   0.012<span style="text-decoration: underline;">5</span>        0      0     1     155.  155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     0.333  51.6  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     0.667 103.  103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     1     155.  155.  155. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_design_npe with spending bound</span></span></span>
<span class="r-in"><span><span class="co"># Design with futility only at analysis 1; efficacy only at analyses 2, 3</span></span></span>
<span class="r-in"><span><span class="co"># Spending bound for efficacy; fixed bound for futility</span></span></span>
<span class="r-in"><span><span class="co"># NOTE: test_upper and test_lower DO NOT WORK with gs_b; must explicitly make bounds infinite</span></span></span>
<span class="r-in"><span><span class="co"># test_upper and test_lower DO WORK with gs_spending_bound</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  <span style="color: #BB0000;">Inf</span>         0           0         0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower   -<span style="color: #BB0000;">1</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper    2.51      0.267       0.006<span style="text-decoration: underline;">05</span>   0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper    1.99      0.900       0.024<span style="text-decoration: underline;">9</span>    0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one can try `info_scale = "h1_info"` or `info_scale = "h0_info"` here</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  info_scale <span class="op">=</span> <span class="st">"h1_info"</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  <span style="color: #BB0000;">Inf</span>         0           0         0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower   -<span style="color: #BB0000;">1</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper    2.51      0.267       0.006<span style="text-decoration: underline;">05</span>   0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper    1.99      0.900       0.024<span style="text-decoration: underline;">9</span>    0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_design_npe with spending function bounds</span></span></span>
<span class="r-in"><span><span class="co"># 2-sided asymmetric bounds</span></span></span>
<span class="r-in"><span><span class="co"># Lower spending based on non-zero effect</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfHSD.html" class="external-link">sfHSD</a></span>, total_spend <span class="op">=</span> <span class="fl">0.1</span>, param <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound      z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71     0.000<span style="text-decoration: underline;">145</span>     0.000<span style="text-decoration: underline;">104</span>   0.1     0.333  43.5  32.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">1.34</span>     0.013<span style="text-decoration: underline;">9</span>       0.090<span style="text-decoration: underline;">9</span>     0.1     0.333  43.5  32.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.51     0.258        0.006<span style="text-decoration: underline;">05</span>    0.2     0.667  87.1  65.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower  0.150    0.046<span style="text-decoration: underline;">0</span>       0.562      0.2     0.667  87.1  65.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  1.99     0.900        0.024<span style="text-decoration: underline;">9</span>     0.3     1     131.   98.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  2.00     0.090<span style="text-decoration: underline;">8</span>       0.976      0.3     1     131.   98.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_design_npe with two-sided symmetric spend, O'Brien-Fleming spending</span></span></span>
<span class="r-in"><span><span class="co"># Typically, 2-sided bounds are binding</span></span></span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xx</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound      z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71     0.001<span style="text-decoration: underline;">04</span>      0.000<span style="text-decoration: underline;">104</span>   0.1     0.333  39.8  39.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">3.08</span>     0.000<span style="text-decoration: underline;">104</span>     0.001<span style="text-decoration: underline;">04</span>    0.1     0.333  39.8  39.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.51     0.233        0.006<span style="text-decoration: underline;">05</span>    0.2     0.667  79.5  79.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">0.728</span>    0.006<span style="text-decoration: underline;">05</span>      0.233      0.2     0.667  79.5  79.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  1.99     0.900        0.025<span style="text-decoration: underline;">0</span>     0.3     1     119.  119. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  1.28     0.025<span style="text-decoration: underline;">0</span>       0.900      0.3     1     119.  119. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Re-use these bounds under alternate hypothesis</span></span></span>
<span class="r-in"><span><span class="co"># Always use binding = TRUE for power calculations</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="op">(</span><span class="va">xx</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">xx</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71  0.001<span style="text-decoration: underline;">04</span>      0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51  0.235        0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99  0.902        0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">3.71</span>  0.000<span style="text-decoration: underline;">007</span>04   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">2.51</span>  0.000<span style="text-decoration: underline;">015</span>1    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">1.99</span>  0.000<span style="text-decoration: underline;">015</span>1    0.3    0.3     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 6 ----</span></span></span>
<span class="r-in"><span><span class="co"># Default of gs_power_npe (single analysis; Type I error controlled)</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span>theta <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  1.96      0.025<span style="text-decoration: underline;">0</span>     0      0         1     1     1     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_power_npe with fixed bound</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, sfu <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71     0.001<span style="text-decoration: underline;">04</span>   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51     0.235     0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99     0.869     0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">1</span>        0.051<span style="text-decoration: underline;">3</span>    0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower  0        0.071<span style="text-decoration: underline;">5</span>    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  0        0.071<span style="text-decoration: underline;">5</span>    0.3    0.3     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same fixed efficacy bounds, no futility bound (i.e., non-binding bound), null hypothesis</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, sfu <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71    0.000<span style="text-decoration: underline;">104</span>     0      0     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51    0.006<span style="text-decoration: underline;">05</span>      0      0     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99    0.025<span style="text-decoration: underline;">0</span>       0      0     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 8 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_power_npe with fixed bound testing futility only at analysis 1; efficacy only at analyses 2, 3</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  <span style="color: #BB0000;">Inf</span>         0        0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper    3         0.113    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper    2         0.887    0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower   -<span style="color: #BB0000;">1.28</span>      0.027<span style="text-decoration: underline;">8</span>   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">Inf</span>         0.027<span style="text-decoration: underline;">8</span>   0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>         0.027<span style="text-decoration: underline;">8</span>   0.3    0.3     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 9 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_power_npe with spending function bounds</span></span></span>
<span class="r-in"><span><span class="co"># Lower spending based on non-zero effect</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfHSD.html" class="external-link">sfHSD</a></span>, total_spend <span class="op">=</span> <span class="fl">0.1</span>, param <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71       0.001<span style="text-decoration: underline;">04</span>   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51       0.235     0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99       0.883     0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">1.36</span>       0.023<span style="text-decoration: underline;">0</span>    0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower  0.072<span style="text-decoration: underline;">6</span>     0.055<span style="text-decoration: underline;">2</span>    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  1.86       0.100     0.3    0.3     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same bounds, but power under different theta</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span>, <span class="fl">.25</span>, <span class="fl">.35</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfHSD.html" class="external-link">sfHSD</a></span>, total_spend <span class="op">=</span> <span class="fl">0.1</span>, param <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound      z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71      0.002<span style="text-decoration: underline;">88</span>  0.15   0.15     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51      0.391    0.25   0.25     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99      0.931    0.35   0.35     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">1.05</span>      0.023<span style="text-decoration: underline;">0</span>   0.15   0.15     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower  0.520     0.055<span style="text-decoration: underline;">2</span>   0.25   0.25     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  2.41      0.100    0.35   0.35     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 10 ----</span></span></span>
<span class="r-in"><span><span class="co"># gs_power_npe with two-sided symmetric spend, O'Brien-Fleming spending</span></span></span>
<span class="r-in"><span><span class="co"># Typically, 2-sided bounds are binding</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Re-use these bounds under alternate hypothesis</span></span></span>
<span class="r-in"><span><span class="co"># Always use binding = TRUE for power calculations</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71  0.001<span style="text-decoration: underline;">04</span>      0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51  0.235        0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99  0.902        0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">3.71</span>  0.000<span style="text-decoration: underline;">007</span>04   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">2.51</span>  0.000<span style="text-decoration: underline;">015</span>1    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">1.99</span>  0.000<span style="text-decoration: underline;">015</span>1    0.3    0.3     1       120   120   120</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 11 ----</span></span></span>
<span class="r-in"><span><span class="co"># Different values of `r` and `tol` lead to different numerical accuracy</span></span></span>
<span class="r-in"><span><span class="co"># Larger `r` and smaller `tol` give better accuracy, but leads to slow computation</span></span></span>
<span class="r-in"><span><span class="va">n_analysis</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="fu">gs_power_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_analysis</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_analysis</span>,</span></span>
<span class="r-in"><span>  info1 <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="va">n_analysis</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Try different combinations of (r, tol) with</span></span></span>
<span class="r-in"><span>  <span class="co"># r in 6, 18, 24, 30, 35, 40, 50, 60, 70, 80, 90, 100</span></span></span>
<span class="r-in"><span>  <span class="co"># tol in 1e-6, 1e-12</span></span></span>
<span class="r-in"><span>  r <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  tol <span class="op">=</span> <span class="fl">1e-6</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    analysis bound       z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>        1 upper    4.88 0.000<span style="text-decoration: underline;">000</span>890   0.1    0.1       0.2     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>        2 upper    3.36 0.000<span style="text-decoration: underline;">650</span>      0.1    0.1       0.4     2     2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>        3 upper    2.68 0.006<span style="text-decoration: underline;">27</span>       0.1    0.1       0.6     3     3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>        4 upper    2.29 0.020<span style="text-decoration: underline;">0</span>        0.1    0.1       0.8     4     4     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>        5 upper    2.03 0.040<span style="text-decoration: underline;">8</span>        0.1    0.1       1       5     5     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>        1 lower -<span style="color: #BB0000;">Inf</span>    0             0.1    0.1       0.2     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>        2 lower -<span style="color: #BB0000;">Inf</span>    0             0.1    0.1       0.4     2     2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>        3 lower -<span style="color: #BB0000;">Inf</span>    0             0.1    0.1       0.6     3     3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>        4 lower -<span style="color: #BB0000;">Inf</span>    0             0.1    0.1       0.8     4     4     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>        5 lower -<span style="color: #BB0000;">Inf</span>    0             0.1    0.1       1       5     5     5</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson, Yujie Zhao, Yilong Zhang, John Blischak, Yihui Xie, Nan Xiao, Jianxiao Yang. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0. <br>Copyright © 2025 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p><span></span></p>
</div>

    </footer></div>





  </body></html>

