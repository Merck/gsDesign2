<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses.
It allows a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and proportionate statistical information
at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package:
non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function
gs_design_nph() will be used; it calls this function.
Initial bound types supported are 1) spending bounds,
fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that
can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that
require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including
the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by gs_power_npe().

"><title>Group sequential design computation with non-constant effect and information — gs_design_npe • gsDesign2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Group sequential design computation with non-constant effect and information — gs_design_npe"><meta property="og:description" content="Derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses.
It allows a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and proportionate statistical information
at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package:
non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function
gs_design_nph() will be used; it calls this function.
Initial bound types supported are 1) spending bounds,
fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that
can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that
require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including
the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by gs_power_npe().

"><meta property="og:image" content="https://merck.github.io/gsDesign2/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsDesign2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/gsDesign2.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Merck/gsDesign2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Group sequential design computation with non-constant effect and information</h1>
      <small class="dont-index">Source: <a href="https://github.com/Merck/gsDesign2/blob/HEAD/R/gs_design_npe.R" class="external-link"><code>R/gs_design_npe.R</code></a></small>
      <div class="d-none name"><code>gs_design_npe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Derives group sequential design size,
bounds and boundary crossing probabilities based on proportionate
information and effect size at analyses.
It allows a non-constant treatment effect over time,
but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and proportionate statistical information
at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package:</p><ol><li><p>non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function
<code>gs_design_nph()</code> will be used; it calls this function.
Initial bound types supported are 1) spending bounds,</p></li>
<li><p>fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that
can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that
require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including
the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by <code><a href="gs_power_npe.html">gs_power_npe()</a></code>.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gs_design_npe</span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  info0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h0_h1_info"</span>, <span class="st">"h0_info"</span>, <span class="st">"h1_info"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>theta</dt>
<dd><p>Natural parameter for group sequential design
representing expected incremental drift at all analyses;
used for power calculation.</p></dd>


<dt>theta0</dt>
<dd><p>Natural parameter used for upper bound spending;
if <code>NULL</code>, this will be set to 0.</p></dd>


<dt>theta1</dt>
<dd><p>Natural parameter used for lower bound spending;
if <code>NULL</code>, this will be set to <code>theta</code>
which yields the usual beta-spending.
If set to 0, spending is 2-sided under null hypothesis.</p></dd>


<dt>info</dt>
<dd><p>Proportionate statistical information at
all analyses for input <code>theta</code>.</p></dd>


<dt>info0</dt>
<dd><p>Proportionate statistical information
under null hypothesis, if different than alternative;
impacts null hypothesis bound calculation.</p></dd>


<dt>info1</dt>
<dd><p>Proportionate statistical information
under alternate hypothesis;
impacts null hypothesis bound calculation.</p></dd>


<dt>info_scale</dt>
<dd><p>Information scale for calculation. Options are:</p><ul><li><p><code>"h0_h1_info"</code> (default): variance under both null and alternative hypotheses is used.</p></li>
<li><p><code>"h0_info"</code>: variance under null hypothesis is used.</p></li>
<li><p><code>"h1_info"</code>: variance under alternative hypothesis is used.</p></li>
</ul></dd>


<dt>alpha</dt>
<dd><p>One-sided Type I error.</p></dd>


<dt>beta</dt>
<dd><p>Type II error.</p></dd>


<dt>upper</dt>
<dd><p>Function to compute upper bound.</p></dd>


<dt>upar</dt>
<dd><p>Parameters passed to the function provided in <code>upper</code>.</p></dd>


<dt>lower</dt>
<dd><p>Function to compare lower bound.</p></dd>


<dt>lpar</dt>
<dd><p>Parameters passed to the function provided in <code>lower</code>.</p></dd>


<dt>test_upper</dt>
<dd><p>Indicator of which analyses should include
an upper (efficacy) bound; single value of <code>TRUE</code> (default) indicates
all analyses; otherwise, a logical vector of the same length as <code>info</code>
should indicate which analyses will have an efficacy bound.</p></dd>


<dt>test_lower</dt>
<dd><p>Indicator of which analyses should include an lower bound;
single value of <code>TRUE</code> (default) indicates all analyses;
single value <code>FALSE</code> indicates no lower bound; otherwise,
a logical vector of the same length as <code>info</code> should indicate which
analyses will have a lower bound.</p></dd>


<dt>binding</dt>
<dd><p>Indicator of whether futility bound is binding;
default of <code>FALSE</code> is recommended.</p></dd>


<dt>r</dt>
<dd><p>Integer value controlling grid for numerical integration
as in Jennison and Turnbull (2000); default is 18, range is 1 to 80.
Larger values provide larger number of grid points and greater accuracy.
Normally <code>r</code> will not be changed by the user.</p></dd>


<dt>tol</dt>
<dd><p>Tolerance parameter for boundary convergence (on Z-scale).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble with columns analysis, bound, z, probability, theta, info, info0.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The inputs <code>info</code> and <code>info0</code> should be
vectors of the same length with increasing positive numbers.
The design returned will change these by some constant scale
factor to ensure the design has power <code>1 - beta</code>.
The bound specifications in <code>upper</code>, <code>lower</code>, <code>upar</code>, <code>lpar</code>
will be used to ensure Type I error and other boundary properties are as specified.</p>
    </div>
    <div class="section level2">
    <h2 id="specification">Specification<a class="anchor" aria-label="anchor" href="#specification"></a></h2>
    

<p>The contents of this section are shown in PDF user manual only.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Keaven Anderson <a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/" class="external-link">gsDesign</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#         example 1                #</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co"># Single analysis</span></span></span>
<span class="r-in"><span><span class="co"># Lachin book p 71 difference of proportions example</span></span></span>
<span class="r-in"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fl">.28</span> <span class="co"># Control response rate</span></span></span>
<span class="r-in"><span><span class="va">pe</span> <span class="op">&lt;-</span> <span class="fl">.40</span> <span class="co"># Experimental response rate</span></span></span>
<span class="r-in"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pc</span> <span class="op">+</span> <span class="va">pe</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="co"># Ave response rate under H0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Information per increment of 1 in sample size</span></span></span>
<span class="r-in"><span><span class="va">info0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">p0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">pc</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pc</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pe</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Result should round up to next even number = 652</span></span></span>
<span class="r-in"><span><span class="co"># Divide information needed under H1 by information per patient added</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span>theta <span class="op">=</span> <span class="va">pe</span> <span class="op">-</span> <span class="va">pc</span>, info <span class="op">=</span> <span class="va">info</span>, info0 <span class="op">=</span> <span class="va">info0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability probability0 theta  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  1.96         0.9        0.025  0.12  737.  725.  737.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info_frac &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#         example 2                #</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co"># Fixed bound</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.0125</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, sfu <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, alpha <span class="op">=</span> <span class="fl">0.0125</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  4.17    0.000<span style="text-decoration: underline;">278</span>    0.000<span style="text-decoration: underline;">015</span>2   0.1     0.333  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">1</span>       0.042<span style="text-decoration: underline;">9</span>      0.159       0.1     0.333  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.85    0.208       0.002<span style="text-decoration: underline;">22</span>     0.2     0.667 103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower  0       0.053<span style="text-decoration: underline;">7</span>      0.513       0.2     0.667 103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  2.26    0.900       0.012<span style="text-decoration: underline;">5</span>      0.3     1     155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  0       0.053<span style="text-decoration: underline;">7</span>      0.606       0.3     1     155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same upper bound; this represents non-binding Type I error and will total 0.025</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">info</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper    4.17   0.000<span style="text-decoration: underline;">015</span>2     0      0     0.333  51.6  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper    2.85   0.002<span style="text-decoration: underline;">22</span>       0      0     0.667 103.  103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper    2.26   0.012<span style="text-decoration: underline;">5</span>        0      0     1     155.  155.  155. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     0.333  51.6  51.6  51.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     0.667 103.  103.  103. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>      0             0      0     1     155.  155.  155. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#         example 3                #</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co"># Spending bound examples</span></span></span>
<span class="r-in"><span><span class="co"># Design with futility only at analysis 1; efficacy only at analyses 2, 3</span></span></span>
<span class="r-in"><span><span class="co"># Spending bound for efficacy; fixed bound for futility</span></span></span>
<span class="r-in"><span><span class="co"># NOTE: test_upper and test_lower DO NOT WORK with gs_b; must explicitly make bounds infinite</span></span></span>
<span class="r-in"><span><span class="co"># test_upper and test_lower DO WORK with gs_spending_bound</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  <span style="color: #BB0000;">Inf</span>         0           0         0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower   -<span style="color: #BB0000;">1</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper    2.51      0.267       0.006<span style="text-decoration: underline;">05</span>   0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper    1.99      0.900       0.024<span style="text-decoration: underline;">9</span>    0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one can try `info_scale = "h1_info"` or `info_scale = "h0_info"` here</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  info_scale <span class="op">=</span> <span class="st">"h1_info"</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound       z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  <span style="color: #BB0000;">Inf</span>         0           0         0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower   -<span style="color: #BB0000;">1</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.1     0.333  44.6  44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper    2.51      0.267       0.006<span style="text-decoration: underline;">05</span>   0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.2     0.667  89.1  89.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper    1.99      0.900       0.024<span style="text-decoration: underline;">9</span>    0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">Inf</span>         0.047<span style="text-decoration: underline;">7</span>      0.159     0.3     1     134.  134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#         example 4                #</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co"># Spending function bounds</span></span></span>
<span class="r-in"><span><span class="co"># 2-sided asymmetric bounds</span></span></span>
<span class="r-in"><span><span class="co"># Lower spending based on non-zero effect</span></span></span>
<span class="r-in"><span><span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  info0 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfHSD.html" class="external-link">sfHSD</a></span>, total_spend <span class="op">=</span> <span class="fl">0.1</span>, param <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound      z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71     0.000<span style="text-decoration: underline;">145</span>     0.000<span style="text-decoration: underline;">104</span>   0.1     0.333  43.5  32.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">1.34</span>     0.013<span style="text-decoration: underline;">9</span>       0.090<span style="text-decoration: underline;">9</span>     0.1     0.333  43.5  32.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.51     0.258        0.006<span style="text-decoration: underline;">05</span>    0.2     0.667  87.1  65.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower  0.150    0.046<span style="text-decoration: underline;">0</span>       0.562      0.2     0.667  87.1  65.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  1.99     0.900        0.024<span style="text-decoration: underline;">9</span>     0.3     1     131.   98.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  2.00     0.090<span style="text-decoration: underline;">8</span>       0.976      0.3     1     131.   98.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#         example 5                #</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------#</span></span></span>
<span class="r-in"><span><span class="co"># Two-sided symmetric spend, O'Brien-Fleming spending</span></span></span>
<span class="r-in"><span><span class="co"># Typically, 2-sided bounds are binding</span></span></span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu">gs_design_npe</span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="fl">0.025</span>, param <span class="op">=</span> <span class="cn">NULL</span>, timing <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xx</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound      z probability probability0 theta info_frac  info info0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71     0.001<span style="text-decoration: underline;">04</span>      0.000<span style="text-decoration: underline;">104</span>   0.1     0.333  39.8  39.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        1 lower -<span style="color: #BB0000;">3.08</span>     0.000<span style="text-decoration: underline;">104</span>     0.001<span style="text-decoration: underline;">04</span>    0.1     0.333  39.8  39.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        2 upper  2.51     0.233        0.006<span style="text-decoration: underline;">05</span>    0.2     0.667  79.5  79.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        2 lower -<span style="color: #BB0000;">0.728</span>    0.006<span style="text-decoration: underline;">05</span>      0.233      0.2     0.667  79.5  79.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        3 upper  1.99     0.900        0.025<span style="text-decoration: underline;">0</span>     0.3     1     119.  119. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower  1.28     0.025<span style="text-decoration: underline;">0</span>       0.900      0.3     1     119.  119. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: info1 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Re-use these bounds under alternate hypothesis</span></span></span>
<span class="r-in"><span><span class="co"># Always use binding = TRUE for power calculations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  binding <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span></span>
<span class="r-in"><span>  upar <span class="op">=</span> <span class="op">(</span><span class="va">xx</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  lpar <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">xx</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis bound     z probability theta theta1 info_frac  info info0 info1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        1 upper  3.71  0.001<span style="text-decoration: underline;">04</span>      0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>        2 upper  2.51  0.235        0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>        3 upper  1.99  0.902        0.3    0.3     1       120   120   120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>        1 lower -<span style="color: #BB0000;">3.71</span>  0.000<span style="text-decoration: underline;">007</span>04   0.1    0.1     0.333    40    40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>        2 lower -<span style="color: #BB0000;">2.51</span>  0.000<span style="text-decoration: underline;">015</span>1    0.2    0.2     0.667    80    80    80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>        3 lower -<span style="color: #BB0000;">1.99</span>  0.000<span style="text-decoration: underline;">015</span>1    0.3    0.3     1       120   120   120</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Keaven Anderson, Yilong Zhang, Yujie Zhao, Jianxiao Yang, Nan Xiao. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7. <br>Copyright © 2023 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p><span></span></p>
</div>

    </footer></div>

  

  

  </body></html>

