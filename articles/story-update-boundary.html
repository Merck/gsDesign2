<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gsDesign2">
<title>Efficacy and futility boundary update • gsDesign2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Efficacy and futility boundary update">
<meta property="og:description" content="gsDesign2">
<meta property="og:image" content="https://merck.github.io/gsDesign2/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsDesign2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/gsDesign2.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Merck/gsDesign2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Efficacy and futility boundary update</h1>
                        <h4 data-toc-skip class="author">Yujie Zhao and
Keaven M. Anderson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Merck/gsDesign2/blob/HEAD/vignettes/articles/story-update-boundary.Rmd" class="external-link"><code>vignettes/articles/story-update-boundary.Rmd</code></a></small>
      <div class="d-none name"><code>story-update-boundary.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/gsDesign2/">gsDesign2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="design-assumptions">Design assumptions<a class="anchor" aria-label="anchor" href="#design-assumptions"></a>
</h2>
<p>We assume two analyses: an interim analysis (IA) and a final analysis
(FA). The IA is planned 20 months after opening enrollment, followed by
the FA at month 36. The planned enrollment period spans 14 months, with
the first 2 months having an enrollment rate of 1/3 the final rate, the
next 2 months with a rate of 2/3 of the final rate, and the final rate
for the remaining 10 months. To obtain the targeted 90% power, these
rates will be multiplied by a constant. The control arm is assumed to
follow an exponential distribution with a median of 9 months and the
dropout rate is 0.0001 per month regardless of treatment group. Finally,
the experimental treatment group is piecewise exponential with a 3-month
delayed treatment effect; that is, in the first 3 months HR = 1 and the
HR is 0.6 thereafter.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Enrollment</span></span>
<span><span class="va">enroll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_enroll_rate.html">define_enroll_rate</a></span><span class="op">(</span></span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Failure and dropout</span></span>
<span><span class="va">fail_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_fail_rate.html">define_fail_rate</a></span><span class="op">(</span></span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">9</span>,</span>
<span>  hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="fl">.0001</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># IA and FA analysis time</span></span>
<span><span class="va">analysis_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">36</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomization ratio</span></span>
<span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div>
<p>We use the null hypothesis information for boundary crossing
probability calculations under both the null and alternate hypotheses.
This will also imply the null hypothesis information will be used for
the information fraction used in spending functions to derive the
design.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info_scale</span> <span class="op">&lt;-</span> <span class="st">"h0_info"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="tabset" id="one-sided-design">One-sided design<a class="anchor" aria-label="anchor" href="#one-sided-design"></a>
</h2>
<p>For the design, we have efficacy bounds at both the IA and FA. We use
the <span class="citation">Lan and DeMets (1983)</span> spending
function with a total alpha of 0.025, which approximates an
O’Brien-Fleming bound.</p>
<div class="section level3">
<h3 id="planned-design">Planned design<a class="anchor" aria-label="anchor" href="#planned-design"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">gs_spending_bound</span></span>
<span><span class="va">upar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="va">alpha</span>, param <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_ahr.html">gs_design_ahr</a></span><span class="op">(</span></span>
<span>  enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="va">fail_rate</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  info_frac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span>
<span>  analysis_time <span class="op">=</span> <span class="va">analysis_time</span>,</span>
<span>  ratio <span class="op">=</span> <span class="va">ratio</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">upar</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/to_integer.html">to_integer</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The planned design targets:</p>
<ul>
<li>Planned events: 193, 297</li>
<li>Planned information fraction for interim and final analysis: 0.6498,
1</li>
<li>Planned alpha spending: 0.0054, 0.025</li>
<li>Planned efficacy bounds: 2.5473, 1.9896</li>
</ul>
<p>We note that rounding up the final targeted events increases power
slightly over the targeted 90%.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Original design"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightcyan"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Efficacy"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="pwsyxbemnu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pwsyxbemnu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pwsyxbemnu thead, #pwsyxbemnu tbody, #pwsyxbemnu tfoot, #pwsyxbemnu tr, #pwsyxbemnu td, #pwsyxbemnu th {
  border-style: none;
}

#pwsyxbemnu p {
  margin: 0;
  padding: 0;
}

#pwsyxbemnu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pwsyxbemnu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pwsyxbemnu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pwsyxbemnu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pwsyxbemnu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pwsyxbemnu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pwsyxbemnu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pwsyxbemnu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pwsyxbemnu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pwsyxbemnu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pwsyxbemnu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pwsyxbemnu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pwsyxbemnu .gt_spanner_row {
  border-bottom-style: hidden;
}

#pwsyxbemnu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pwsyxbemnu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pwsyxbemnu .gt_from_md > :first-child {
  margin-top: 0;
}

#pwsyxbemnu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pwsyxbemnu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pwsyxbemnu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pwsyxbemnu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pwsyxbemnu .gt_row_group_first td {
  border-top-width: 2px;
}

#pwsyxbemnu .gt_row_group_first th {
  border-top-width: 2px;
}

#pwsyxbemnu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pwsyxbemnu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pwsyxbemnu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pwsyxbemnu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pwsyxbemnu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pwsyxbemnu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pwsyxbemnu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pwsyxbemnu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pwsyxbemnu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pwsyxbemnu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pwsyxbemnu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pwsyxbemnu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pwsyxbemnu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pwsyxbemnu .gt_left {
  text-align: left;
}

#pwsyxbemnu .gt_center {
  text-align: center;
}

#pwsyxbemnu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pwsyxbemnu .gt_font_normal {
  font-weight: normal;
}

#pwsyxbemnu .gt_font_bold {
  font-weight: bold;
}

#pwsyxbemnu .gt_font_italic {
  font-style: italic;
}

#pwsyxbemnu .gt_super {
  font-size: 65%;
}

#pwsyxbemnu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pwsyxbemnu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pwsyxbemnu .gt_indent_1 {
  text-indent: 5px;
}

#pwsyxbemnu .gt_indent_2 {
  text-indent: 10px;
}

#pwsyxbemnu .gt_indent_3 {
  text-indent: 15px;
}

#pwsyxbemnu .gt_indent_4 {
  text-indent: 20px;
}

#pwsyxbemnu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Original design</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id='Nominal p&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>Nominal p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id='~HR at bound&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/span&gt;'>~HR at bound<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span>
</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <span class="gt_column_spanner">Cumulative boundary crossing probability</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null hypothesis">Null hypothesis</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65">Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">2.55</td>
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  Nominal p" class="gt_row gt_right">0.0054</td>
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  ~HR at bound" class="gt_row gt_right">0.6930</td>
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  Alternate hypothesis" class="gt_row gt_right">0.3494</td>
<td headers="Analysis: 1 Time: 19.9 N: 366 Event: 193 AHR: 0.73 Information fraction: 0.65  Null hypothesis" class="gt_row gt_right">0.0054</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1">Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">1.99</td>
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0233</td>
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  ~HR at bound" class="gt_row gt_right">0.7938</td>
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9023</td>
<td headers="Analysis: 2 Time: 35.8 N: 366 Event: 297 AHR: 0.68 Information fraction: 1  Null hypothesis" class="gt_row gt_right">0.0250</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="6">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> One-sided p-value for experimental vs control treatment.
          Value &lt; 0.5 favors experimental, &gt; 0.5 favors control.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="6">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> Approximate hazard ratio to cross bound.</td>
    </tr>
</tfoot>
</table>
</div>
</div>
<div class="section level3">
<h3 id="blinded-estimation-of-ahr">Blinded estimation of AHR<a class="anchor" aria-label="anchor" href="#blinded-estimation-of-ahr"></a>
</h3>
<p>We provide a simulation below where 188 and 295 events observed at
the IA and FA, respectively. We will assume the differences from planned
(193, 297) are due to logistical considerations. We also assume the
protocol specifies that the full <span class="math inline">\(\alpha\)</span> will be spent at the final
analysis even in a case like this where there is a shortfall of events
versus the design plan.</p>
<p>The observed data for this example is generated by
<code><a href="https://merck.github.io/simtrial/reference/sim_pw_surv.html" class="external-link">simtrial::sim_pw_surv()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/sim_pw_surv.html" class="external-link">sim_pw_surv</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">analysis</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span>,</span>
<span>  stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>stratum <span class="op">=</span> <span class="st">"All"</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"experimental"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  enroll_rate <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">enroll_rate</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="op">(</span><span class="va">fail_rate</span> <span class="op">|&gt;</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/to_sim_pw_surv.html" class="external-link">to_sim_pw_surv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">fail_rate</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="op">(</span><span class="va">fail_rate</span> <span class="op">|&gt;</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/to_sim_pw_surv.html" class="external-link">to_sim_pw_surv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dropout_rate</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To calculate the blinded estimation of AHR (i.e.,
<code>theta1</code>), we have 2 options. Both options yield the same
results. Option 1 is useful when the event counts are available or when
the methods need explanation. Option 2 is simple for scenarios where
time-to-event data is available as a single function call is needed to
get the needed <code>theta1</code> and AHR for each analysis.</p>
<div class="section level4">
<h4 id="option-1">Option 1<a class="anchor" aria-label="anchor" href="#option-1"></a>
</h4>
<p>We summarize event counts by HR interval for each analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="co"># Cut points for hazard rate intervals specified</span></span>
<span><span class="va">t_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">fail_rate</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">analysis_time</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">observed_data_i</span> <span class="op">&lt;-</span> <span class="va">observed_data</span> <span class="op">|&gt;</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/cut_data_by_date.html" class="external-link">cut_data_by_date</a></span><span class="op">(</span><span class="va">analysis_time</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fail_rate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">observed_data_i</span><span class="op">$</span><span class="va">event</span> <span class="op">*</span> <span class="op">(</span><span class="va">observed_data_i</span><span class="op">$</span><span class="va">tte</span> <span class="op">&gt;</span> <span class="va">t_cut</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">observed_data_i</span><span class="op">$</span><span class="va">tte</span> <span class="op">&lt;=</span> <span class="va">t_cut</span><span class="op">[</span><span class="va">j</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">counts_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">counts_table</span>,</span>
<span>                          <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="va">i</span>, Interval <span class="op">=</span> <span class="va">j</span>, Events <span class="op">=</span> <span class="va">events</span>, HR <span class="op">=</span> <span class="va">fail_rate</span><span class="op">$</span><span class="va">hr</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">counts_table</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span><span class="st">"Counts by HR interval for each analysis"</span><span class="op">)</span></span></code></pre></div>
<div id="kxmtddkutf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kxmtddkutf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kxmtddkutf thead, #kxmtddkutf tbody, #kxmtddkutf tfoot, #kxmtddkutf tr, #kxmtddkutf td, #kxmtddkutf th {
  border-style: none;
}

#kxmtddkutf p {
  margin: 0;
  padding: 0;
}

#kxmtddkutf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kxmtddkutf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kxmtddkutf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kxmtddkutf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kxmtddkutf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxmtddkutf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxmtddkutf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxmtddkutf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kxmtddkutf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kxmtddkutf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kxmtddkutf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kxmtddkutf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kxmtddkutf .gt_spanner_row {
  border-bottom-style: hidden;
}

#kxmtddkutf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kxmtddkutf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kxmtddkutf .gt_from_md > :first-child {
  margin-top: 0;
}

#kxmtddkutf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kxmtddkutf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kxmtddkutf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kxmtddkutf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kxmtddkutf .gt_row_group_first td {
  border-top-width: 2px;
}

#kxmtddkutf .gt_row_group_first th {
  border-top-width: 2px;
}

#kxmtddkutf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxmtddkutf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kxmtddkutf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kxmtddkutf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxmtddkutf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxmtddkutf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kxmtddkutf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kxmtddkutf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kxmtddkutf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxmtddkutf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxmtddkutf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxmtddkutf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxmtddkutf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxmtddkutf .gt_left {
  text-align: left;
}

#kxmtddkutf .gt_center {
  text-align: center;
}

#kxmtddkutf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kxmtddkutf .gt_font_normal {
  font-weight: normal;
}

#kxmtddkutf .gt_font_bold {
  font-weight: bold;
}

#kxmtddkutf .gt_font_italic {
  font-style: italic;
}

#kxmtddkutf .gt_super {
  font-size: 65%;
}

#kxmtddkutf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kxmtddkutf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kxmtddkutf .gt_indent_1 {
  text-indent: 5px;
}

#kxmtddkutf .gt_indent_2 {
  text-indent: 10px;
}

#kxmtddkutf .gt_indent_3 {
  text-indent: 15px;
}

#kxmtddkutf .gt_indent_4 {
  text-indent: 20px;
}

#kxmtddkutf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Counts by HR interval for each analysis</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Interval">Interval</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Events">Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="HR">HR</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Analysis" class="gt_row gt_right">1</td>
<td headers="Interval" class="gt_row gt_right">1</td>
<td headers="Events" class="gt_row gt_right">75</td>
<td headers="HR" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_right">2</td>
<td headers="Interval" class="gt_row gt_right">1</td>
<td headers="Events" class="gt_row gt_right">75</td>
<td headers="HR" class="gt_row gt_right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_observed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">counts_table</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Events</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">event</span></span></code></pre></div>
<p>This can be converted to a blinded estimate of AHR and standardized
effect size <code>theta</code> as follows: We let <span class="math inline">\(j\)</span> index analyses and <span class="math inline">\(i\)</span> index the constant failure rate
intervals input in <code>fail_rate</code> above. The basic computation
is based on the number of events in each of the <span class="math inline">\(i\)</span> intervals at each analysis. We denote
the assumed hazard ratio in interval <span class="math inline">\(i\)</span> as <span class="math inline">\(\text{HR}_i\)</span> For analysis <span class="math inline">\(j\)</span></p>
<p><span class="math display">\[
  -\log(\text{AHR}_j) = -\log(\sum_{i=1}^m w_{ij} \; \text{HR}_i),
\]</span> where the weight is determined by the ratio of observed number
of events occurring in each constant hazard rate interval at analysis
<span class="math inline">\(j\)</span> divided by the observed total
events at analysis <span class="math inline">\(j\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blinded_ahr</span> <span class="op">&lt;-</span> <span class="va">counts_table</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Events</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">HR</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Events</span><span class="op">)</span>,</span>
<span>            AHR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>            Events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Events</span><span class="op">)</span>,</span>
<span>            info0 <span class="op">=</span> <span class="va">Events</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">ratio</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">ratio</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">blinded_ahr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span><span class="st">"Blinded AHR estimate for each analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta"</span>, <span class="st">"AHR"</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#009999"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">theta</span>,</span>
<span>      rows <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="jtqkhuezsk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jtqkhuezsk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jtqkhuezsk thead, #jtqkhuezsk tbody, #jtqkhuezsk tfoot, #jtqkhuezsk tr, #jtqkhuezsk td, #jtqkhuezsk th {
  border-style: none;
}

#jtqkhuezsk p {
  margin: 0;
  padding: 0;
}

#jtqkhuezsk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jtqkhuezsk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jtqkhuezsk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jtqkhuezsk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jtqkhuezsk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtqkhuezsk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtqkhuezsk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtqkhuezsk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jtqkhuezsk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jtqkhuezsk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jtqkhuezsk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jtqkhuezsk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jtqkhuezsk .gt_spanner_row {
  border-bottom-style: hidden;
}

#jtqkhuezsk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jtqkhuezsk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jtqkhuezsk .gt_from_md > :first-child {
  margin-top: 0;
}

#jtqkhuezsk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jtqkhuezsk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jtqkhuezsk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jtqkhuezsk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jtqkhuezsk .gt_row_group_first td {
  border-top-width: 2px;
}

#jtqkhuezsk .gt_row_group_first th {
  border-top-width: 2px;
}

#jtqkhuezsk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtqkhuezsk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jtqkhuezsk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jtqkhuezsk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtqkhuezsk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtqkhuezsk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jtqkhuezsk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jtqkhuezsk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jtqkhuezsk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtqkhuezsk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtqkhuezsk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtqkhuezsk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtqkhuezsk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtqkhuezsk .gt_left {
  text-align: left;
}

#jtqkhuezsk .gt_center {
  text-align: center;
}

#jtqkhuezsk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jtqkhuezsk .gt_font_normal {
  font-weight: normal;
}

#jtqkhuezsk .gt_font_bold {
  font-weight: bold;
}

#jtqkhuezsk .gt_font_italic {
  font-style: italic;
}

#jtqkhuezsk .gt_super {
  font-size: 65%;
}

#jtqkhuezsk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jtqkhuezsk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jtqkhuezsk .gt_indent_1 {
  text-indent: 5px;
}

#jtqkhuezsk .gt_indent_2 {
  text-indent: 10px;
}

#jtqkhuezsk .gt_indent_3 {
  text-indent: 15px;
}

#jtqkhuezsk .gt_indent_4 {
  text-indent: 20px;
}

#jtqkhuezsk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Blinded AHR estimate for each analysis</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="theta">theta</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AHR">AHR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Events">Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="info0">info0</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Analysis" class="gt_row gt_right">1</td>
<td headers="theta" class="gt_row gt_right" style="background-color: #009999; font-weight: bold;">0.000</td>
<td headers="AHR" class="gt_row gt_right">1.000</td>
<td headers="Events" class="gt_row gt_right">75</td>
<td headers="info0" class="gt_row gt_right">18.75</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_right">2</td>
<td headers="theta" class="gt_row gt_right" style="background-color: #009999; font-weight: bold;">0.000</td>
<td headers="AHR" class="gt_row gt_right">1.000</td>
<td headers="Events" class="gt_row gt_right">75</td>
<td headers="info0" class="gt_row gt_right">18.75</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>
<strong>Option 2:</strong> we use the blinded data to estimate the
AHR and <code>theta1</code> is the negative logarithm of the estimated
AHR.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># theta1 at IA</span></span>
<span><span class="va">observed_data_ia</span> <span class="op">&lt;-</span> <span class="va">observed_data</span> <span class="op">|&gt;</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/cut_data_by_date.html" class="external-link">cut_data_by_date</a></span><span class="op">(</span><span class="va">analysis_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">blinded_ahr_ia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ahr_blinded.html">ahr_blinded</a></span><span class="op">(</span>surv <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">observed_data_ia</span><span class="op">$</span><span class="va">tte</span>, event <span class="op">=</span> <span class="va">observed_data_ia</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>,</span>
<span>                              intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                              hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>                              ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># theta1 at FA</span></span>
<span><span class="va">observed_data_fa</span> <span class="op">&lt;-</span> <span class="va">observed_data</span> <span class="op">|&gt;</span> <span class="fu">simtrial</span><span class="fu">::</span><span class="fu"><a href="https://merck.github.io/simtrial/reference/cut_data_by_date.html" class="external-link">cut_data_by_date</a></span><span class="op">(</span><span class="va">analysis_time</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">blinded_ahr_fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ahr_blinded.html">ahr_blinded</a></span><span class="op">(</span>surv <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">observed_data_fa</span><span class="op">$</span><span class="va">tte</span>, event <span class="op">=</span> <span class="va">observed_data_fa</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>,</span>
<span>                              intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                              hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>                              ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine both IA and FA</span></span>
<span><span class="va">blinded_ahr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">blinded_ahr_ia</span>, <span class="va">blinded_ahr_fa</span><span class="op">)</span></span>
<span><span class="va">blinded_ahr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span><span class="st">"Blinded AHR estimates from ahr_blinded()"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span>style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#009999"</span><span class="op">)</span>, <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">theta</span>, rows <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="ablncptzdd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ablncptzdd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ablncptzdd thead, #ablncptzdd tbody, #ablncptzdd tfoot, #ablncptzdd tr, #ablncptzdd td, #ablncptzdd th {
  border-style: none;
}

#ablncptzdd p {
  margin: 0;
  padding: 0;
}

#ablncptzdd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ablncptzdd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ablncptzdd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ablncptzdd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ablncptzdd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ablncptzdd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ablncptzdd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ablncptzdd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ablncptzdd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ablncptzdd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ablncptzdd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ablncptzdd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ablncptzdd .gt_spanner_row {
  border-bottom-style: hidden;
}

#ablncptzdd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ablncptzdd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ablncptzdd .gt_from_md > :first-child {
  margin-top: 0;
}

#ablncptzdd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ablncptzdd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ablncptzdd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ablncptzdd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ablncptzdd .gt_row_group_first td {
  border-top-width: 2px;
}

#ablncptzdd .gt_row_group_first th {
  border-top-width: 2px;
}

#ablncptzdd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ablncptzdd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ablncptzdd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ablncptzdd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ablncptzdd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ablncptzdd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ablncptzdd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ablncptzdd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ablncptzdd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ablncptzdd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ablncptzdd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ablncptzdd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ablncptzdd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ablncptzdd .gt_left {
  text-align: left;
}

#ablncptzdd .gt_center {
  text-align: center;
}

#ablncptzdd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ablncptzdd .gt_font_normal {
  font-weight: normal;
}

#ablncptzdd .gt_font_bold {
  font-weight: bold;
}

#ablncptzdd .gt_font_italic {
  font-style: italic;
}

#ablncptzdd .gt_super {
  font-size: 65%;
}

#ablncptzdd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ablncptzdd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ablncptzdd .gt_indent_1 {
  text-indent: 5px;
}

#ablncptzdd .gt_indent_2 {
  text-indent: 10px;
}

#ablncptzdd .gt_indent_3 {
  text-indent: 15px;
}

#ablncptzdd .gt_indent_4 {
  text-indent: 20px;
}

#ablncptzdd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Blinded AHR estimates from ahr_blinded()</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="event">event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ahr">ahr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="theta">theta</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="info0">info0</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="event" class="gt_row gt_right">188</td>
<td headers="ahr" class="gt_row gt_right">0.7356221</td>
<td headers="theta" class="gt_row gt_right" style="background-color: #009999; font-weight: bold;">0.3070388</td>
<td headers="info0" class="gt_row gt_right">47.00</td>
</tr>
<tr>
<td headers="event" class="gt_row gt_right">295</td>
<td headers="ahr" class="gt_row gt_right">0.6832088</td>
<td headers="theta" class="gt_row gt_right" style="background-color: #009999; font-weight: bold;">0.3809547</td>
<td headers="info0" class="gt_row gt_right">73.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 class="tabset" id="updating-the-design">Updating the design<a class="anchor" aria-label="anchor" href="#updating-the-design"></a>
</h3>
<p>We compute boundary crossing probabilities under H0 and H1
separately.</p>
<div class="section level4">
<h4 id="h0">H0<a class="anchor" aria-label="anchor" href="#h0"></a>
</h4>
<p>We will utilize the <code><a href="../reference/gs_power_npe.html">gs_power_npe()</a></code> function to update
efficacy bounds based on the observed events. The details of arguments
and implementation are explained in the Appendix.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upar_update</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">upar</span></span>
<span><span class="co"># Now update timing parameter for the interim analysis.</span></span>
<span><span class="co"># Interim spending based on observed events divided by final planned events.</span></span>
<span><span class="co"># The remaining alpha will be allocated to FA.</span></span>
<span><span class="va">upar_update</span><span class="op">$</span><span class="va">timing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">event_observed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_updated_h0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span>
<span>  <span class="co"># `theta = 0` provides the crossing probability under H0</span></span>
<span>  theta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co"># Observed statistical information under H0</span></span>
<span>  info <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">info0</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span>
<span>  <span class="co"># Upper bound uses spending function from planned design</span></span>
<span>  upper <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">upar_update</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_upper</span>,</span>
<span>  <span class="co"># No lower bound, but copy this from input</span></span>
<span>  lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  lpar <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">lpar</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_lower</span>,</span>
<span>  <span class="co"># Binding</span></span>
<span>  binding <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">binding</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The updated efficacy bounds are 4.309, 1.96.</p>
</div>
<div class="section level4">
<h4 id="h1">H1<a class="anchor" aria-label="anchor" href="#h1"></a>
</h4>
<p>To calculate power of the updated boundaries, we use
<code>gs_power_npe</code>. Different from crossing probability under H0
with <code>theta= 0</code> in <code>gs_power_npe</code>, we update the
value of <code>theta</code> to the treatment effect under H1.</p>
<p>A value of <code>theta1</code> is computed with one of the blinded
AHR methods above and incorporated below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_updated_h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span>
<span>  <span class="co"># An `theta` under H1 provides the power of the updated boundaries</span></span>
<span>  theta <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>  <span class="co"># Observed statistical information under H0,</span></span>
<span>  <span class="co"># same as info = event_observed * x$input$ratio / (1 + x$input$ratio)^2</span></span>
<span>  info <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">info0</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span>
<span>  <span class="co"># Upper bound uses updated efficacy bounds</span></span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">x_updated_h0</span><span class="op">$</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">]</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_upper</span>,</span>
<span>  <span class="co"># No lower bound, but copy this from input</span></span>
<span>  lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  lpar <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">lpar</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_lower</span>,</span>
<span>  <span class="co"># Binding</span></span>
<span>  binding <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">binding</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summary-table">Summary table<a class="anchor" aria-label="anchor" href="#summary-table"></a>
</h4>
<p>Now we combine the results under H0 and H1 for a complete summary
table.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tidy summary table for the updated design</span></span>
<span><span class="va">table_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">analysis</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  N <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">n</span>,</span>
<span>                  `Observed Events` <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">event</span>,</span>
<span>                  `Information fraction` <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">info_frac</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">analysis</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  Bound <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  Z <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  `~HR at bound` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x_updated_h0</span><span class="op">$</span><span class="va">info0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  `Nominal p` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span><span class="op">)</span>,</span>
<span>                  `Alternate hypothesis` <span class="op">=</span> <span class="va">x_updated_h1</span><span class="op">$</span><span class="va">probability</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  `Null hypothesis` <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">probability</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsDesign2</span><span class="fu">:::</span><span class="fu">table_ab</span><span class="op">(</span>table_a <span class="op">=</span> <span class="va">table_a</span>,</span>
<span>                     table_b <span class="op">=</span> <span class="va">table_b</span>,</span>
<span>                     decimals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                     byvar <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Bound <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">Bound</span>, <span class="st">"upper"</span> <span class="op">=</span> <span class="st">"Efficacy"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Updated design"</span>, subtitle <span class="op">=</span> <span class="st">"by event fraction based timing"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`Alternate hypothesis`</span>, <span class="va">`Null hypothesis`</span><span class="op">)</span>,</span>
<span>              label <span class="op">=</span> <span class="st">"Cumulative boundary crossing probability"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightcyan"</span><span class="op">)</span>,</span>
<span>                 <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">Z</span>, rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Efficacy"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="zayqudqgye" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zayqudqgye table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zayqudqgye thead, #zayqudqgye tbody, #zayqudqgye tfoot, #zayqudqgye tr, #zayqudqgye td, #zayqudqgye th {
  border-style: none;
}

#zayqudqgye p {
  margin: 0;
  padding: 0;
}

#zayqudqgye .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zayqudqgye .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zayqudqgye .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zayqudqgye .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zayqudqgye .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zayqudqgye .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zayqudqgye .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zayqudqgye .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zayqudqgye .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zayqudqgye .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zayqudqgye .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zayqudqgye .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zayqudqgye .gt_spanner_row {
  border-bottom-style: hidden;
}

#zayqudqgye .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zayqudqgye .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zayqudqgye .gt_from_md > :first-child {
  margin-top: 0;
}

#zayqudqgye .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zayqudqgye .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zayqudqgye .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zayqudqgye .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zayqudqgye .gt_row_group_first td {
  border-top-width: 2px;
}

#zayqudqgye .gt_row_group_first th {
  border-top-width: 2px;
}

#zayqudqgye .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zayqudqgye .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zayqudqgye .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zayqudqgye .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zayqudqgye .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zayqudqgye .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zayqudqgye .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zayqudqgye .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zayqudqgye .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zayqudqgye .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zayqudqgye .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zayqudqgye .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zayqudqgye .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zayqudqgye .gt_left {
  text-align: left;
}

#zayqudqgye .gt_center {
  text-align: center;
}

#zayqudqgye .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zayqudqgye .gt_font_normal {
  font-weight: normal;
}

#zayqudqgye .gt_font_bold {
  font-weight: bold;
}

#zayqudqgye .gt_font_italic {
  font-style: italic;
}

#zayqudqgye .gt_super {
  font-size: 65%;
}

#zayqudqgye .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zayqudqgye .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zayqudqgye .gt_indent_1 {
  text-indent: 5px;
}

#zayqudqgye .gt_indent_2 {
  text-indent: 10px;
}

#zayqudqgye .gt_indent_3 {
  text-indent: 15px;
}

#zayqudqgye .gt_indent_4 {
  text-indent: 20px;
}

#zayqudqgye .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal" style>Updated design</td>
    </tr>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>by event fraction based timing</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="~HR at bound">~HR at bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Nominal p">Nominal p</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <span class="gt_column_spanner">Cumulative boundary crossing probability</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null hypothesis">Null hypothesis</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64">Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">4.3094</td>
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  ~HR at bound" class="gt_row gt_right">0.5333</td>
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  Nominal p" class="gt_row gt_right">0.0000</td>
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  Alternate hypothesis" class="gt_row gt_right">0.0137</td>
<td headers="Analysis: 1 N: 366 Observed Events: 188 Information fraction: 0.64  Null hypothesis" class="gt_row gt_right">0.0000</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1">Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">1.9600</td>
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  ~HR at bound" class="gt_row gt_right">0.7959</td>
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0250</td>
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9052</td>
<td headers="Analysis: 2 N: 366 Observed Events: 295 Information fraction: 1  Null hypothesis" class="gt_row gt_right">0.0250</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 class="tabset" id="two-sided-asymmetric-design-beta-spending-with-non-binding-lower-bound">Two-sided asymmetric design, beta-spending with
non-binding lower bound<a class="anchor" aria-label="anchor" href="#two-sided-asymmetric-design-beta-spending-with-non-binding-lower-bound"></a>
</h2>
<p>In this section, we investigate a 2 sided asymmetric design, with the
non-binding beta-spending futility bounds. Beta-spending refers to error
spending for the lower bound crossing probabilities under the
alternative hypothesis. Non-binding assumes the trial continues if the
lower bound is crossed for Type I, but not Type II error
computation.</p>
<div class="section level3">
<h3 id="planned-design-1">Planned design<a class="anchor" aria-label="anchor" href="#planned-design-1"></a>
</h3>
<p>In the original designs, we employ the Lan-DeMets spending function
used to approximate O’Brien-Fleming bounds <span class="citation">(Lan
and DeMets 1983)</span> for both efficacy and futility bounds. The total
spending for efficacy is 0.025, and for futility is 0.1. Besides, we
assume the futility test only happens at IA.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">gs_spending_bound</span></span>
<span><span class="va">upar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="va">alpha</span>, param <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">gs_spending_bound</span></span>
<span><span class="va">lpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLDOF.html" class="external-link">sfLDOF</a></span>, total_spend <span class="op">=</span> <span class="va">beta</span>, param <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_ahr.html">gs_design_ahr</a></span><span class="op">(</span></span>
<span>  enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="va">fail_rate</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  info_frac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span>
<span>  analysis_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">36</span><span class="op">)</span>,</span>
<span>  ratio <span class="op">=</span> <span class="va">ratio</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_spending_bound</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">upar</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">lower</span>,</span>
<span>  lpar <span class="op">=</span> <span class="va">lpar</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/to_integer.html">to_integer</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In the planned design, we have</p>
<ul>
<li>Planned events: 202, 311</li>
<li>Planned information fraction (timing): 0.6495, 1</li>
<li>Planned alpha spending: 0.0054167, 0.025</li>
<li>Planned efficacy bounds: 2.548, 1.9895</li>
<li>Planned futility bounds: 0.4778</li>
</ul>
<p>Since we added futility bounds, the sample size and number of events
are larger than what we have in the 1-sided example.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Original design"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightcyan"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Efficacy"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F9E3D6"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Futility"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="ificiqcfrq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ificiqcfrq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ificiqcfrq thead, #ificiqcfrq tbody, #ificiqcfrq tfoot, #ificiqcfrq tr, #ificiqcfrq td, #ificiqcfrq th {
  border-style: none;
}

#ificiqcfrq p {
  margin: 0;
  padding: 0;
}

#ificiqcfrq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ificiqcfrq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ificiqcfrq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ificiqcfrq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ificiqcfrq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ificiqcfrq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ificiqcfrq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ificiqcfrq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ificiqcfrq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ificiqcfrq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ificiqcfrq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ificiqcfrq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ificiqcfrq .gt_spanner_row {
  border-bottom-style: hidden;
}

#ificiqcfrq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ificiqcfrq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ificiqcfrq .gt_from_md > :first-child {
  margin-top: 0;
}

#ificiqcfrq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ificiqcfrq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ificiqcfrq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ificiqcfrq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ificiqcfrq .gt_row_group_first td {
  border-top-width: 2px;
}

#ificiqcfrq .gt_row_group_first th {
  border-top-width: 2px;
}

#ificiqcfrq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ificiqcfrq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ificiqcfrq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ificiqcfrq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ificiqcfrq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ificiqcfrq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ificiqcfrq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ificiqcfrq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ificiqcfrq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ificiqcfrq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ificiqcfrq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ificiqcfrq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ificiqcfrq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ificiqcfrq .gt_left {
  text-align: left;
}

#ificiqcfrq .gt_center {
  text-align: center;
}

#ificiqcfrq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ificiqcfrq .gt_font_normal {
  font-weight: normal;
}

#ificiqcfrq .gt_font_bold {
  font-weight: bold;
}

#ificiqcfrq .gt_font_italic {
  font-style: italic;
}

#ificiqcfrq .gt_super {
  font-size: 65%;
}

#ificiqcfrq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ificiqcfrq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ificiqcfrq .gt_indent_1 {
  text-indent: 5px;
}

#ificiqcfrq .gt_indent_2 {
  text-indent: 10px;
}

#ificiqcfrq .gt_indent_3 {
  text-indent: 15px;
}

#ificiqcfrq .gt_indent_4 {
  text-indent: 20px;
}

#ificiqcfrq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Original design</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id='Nominal p&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>Nominal p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id='~HR at bound&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/span&gt;'>~HR at bound<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span>
</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <span class="gt_column_spanner">Cumulative boundary crossing probability</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null hypothesis">Null hypothesis</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65">Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Bound" class="gt_row gt_left">Futility</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Z" class="gt_row gt_right" style="background-color: #F9E3D6; font-weight: bold;">0.48</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Nominal p" class="gt_row gt_right">0.3164</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  ~HR at bound" class="gt_row gt_right">0.9350</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Alternate hypothesis" class="gt_row gt_right">0.0413</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Null hypothesis" class="gt_row gt_right">0.6836</td>
</tr>
<tr>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">2.55</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Nominal p" class="gt_row gt_right">0.0054</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  ~HR at bound" class="gt_row gt_right">0.6987</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Alternate hypothesis" class="gt_row gt_right">0.3692</td>
<td headers="Analysis: 1 Time: 19.9 N: 382 Event: 202 AHR: 0.73 Information fraction: 0.65  Null hypothesis" class="gt_row gt_right">0.0054</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1">Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">1.99</td>
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0233</td>
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  ~HR at bound" class="gt_row gt_right">0.7980</td>
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9030</td>
<td headers="Analysis: 2 Time: 36.1 N: 382 Event: 311 AHR: 0.68 Information fraction: 1  Null hypothesis" class="gt_row gt_right">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span> 0.0247</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="6">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> One-sided p-value for experimental vs control treatment.
          Value &lt; 0.5 favors experimental, &gt; 0.5 favors control.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="6">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> Approximate hazard ratio to cross bound.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="6">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span> Cumulative alpha for final analysis (0.0247) is less than the full alpha (0.025) when the futility bound is non-binding. The smaller value subtracts the probability of crossing a futility bound before crossing an efficacy bound at a later analysis (0.025 - 0.0003 = 0.0247) under the null hypothesis.</td>
    </tr>
</tfoot>
</table>
</div>
<p>For simplicity in presentation, we assume the observed events are the
same as that in the 1-sided design.</p>
<div class="section level4">
<h4 id="updated-efficacy-and-futility-bounds-and-crossing-probability-under-h0">Updated efficacy and futility bounds and crossing probability under
H0<a class="anchor" aria-label="anchor" href="#updated-efficacy-and-futility-bounds-and-crossing-probability-under-h0"></a>
</h4>
<p>Again, we use <code><a href="../reference/gs_power_npe.html">gs_power_npe()</a></code> to calculate the updated
efficacy and futility bounds. The details of its arguments and
implementations are explained in the Appendix. We initially set up
<code>theta = 0</code> for crossing probability under the null
hypothesis and <code>theta0 = 0</code> for null hypothesis. We use the
same <code>theta1</code> we calculated previously.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upar_update</span>  <span class="op">&lt;-</span> <span class="va">upar</span></span>
<span><span class="va">upar_update</span><span class="op">$</span><span class="va">timing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">event_observed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lpar_update</span> <span class="op">&lt;-</span> <span class="va">lpar</span></span>
<span><span class="va">lpar_update</span><span class="op">$</span><span class="va">timing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">event_observed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">event</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x_updated_h0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span>
<span>  <span class="co"># `theta = 0` provides the crossing probability under H0.</span></span>
<span>  <span class="co"># Users have the flexibility to modify the value of `theta`,</span></span>
<span>  <span class="co"># if they are interested in the crossing probability under H1 or other scenarios.</span></span>
<span>  theta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co"># -log(AHR) = 0 for H0 is used for determining upper spending</span></span>
<span>  theta0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co"># -log(AHR) for H1 is used for determining the lower spending and bounds</span></span>
<span>  theta1 <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>  <span class="co"># Observed statistical information under H0 with equal randomization</span></span>
<span>  info <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">info0</span>,</span>
<span>  <span class="co"># Upper bound</span></span>
<span>  upper <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">upar_update</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Lower bound</span></span>
<span>  lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  lpar <span class="op">=</span> <span class="va">lpar_update</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  binding <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">binding</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The updated efficacy bounds are 4.417, 1.96, and the updated futility
bounds are -1.047, -.</p>
</div>
<div class="section level4">
<h4 id="crossing-probability-under-h1">Crossing probability under H1<a class="anchor" aria-label="anchor" href="#crossing-probability-under-h1"></a>
</h4>
<p>Following the same argument in the 1-sided design, we can calculate
the updated power as</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_updated_h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span></span>
<span>  <span class="co"># An `theta` under H1 provides the power of the updated boundaries</span></span>
<span>  theta <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>  <span class="co"># Observed statistical information under H0</span></span>
<span>  info <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">info0</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="st">"h0_info"</span>,</span>
<span>  <span class="co"># Upper bound uses updated efficacy bounds</span></span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">x_updated_h0</span><span class="op">$</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">]</span>,</span>
<span>  test_upper <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_upper</span>,</span>
<span>  <span class="co"># Lower bound uses updated futility bounds</span></span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lpar <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">x_updated_h0</span><span class="op">$</span><span class="va">bound</span> <span class="op">==</span> <span class="st">"lower"</span><span class="op">]</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">test_lower</span>,</span>
<span>  <span class="co"># Binding</span></span>
<span>  binding <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">binding</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summary-table-1">Summary table<a class="anchor" aria-label="anchor" href="#summary-table-1"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tidy summary table for the updated design</span></span>
<span><span class="va">table_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">analysis</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                  N <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">n</span>,</span>
<span>                  `Observed Events` <span class="op">=</span> <span class="va">blinded_ahr</span><span class="op">$</span><span class="va">event</span>,</span>
<span>                  `Information fraction` <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">info_frac</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">analysis</span>,</span>
<span>                  Bound <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>                  Z <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">z</span>,</span>
<span>                  `~HR at bound` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x_updated_h0</span><span class="op">$</span><span class="va">info0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  `Nominal p` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span><span class="op">)</span>,</span>
<span>                  `Alternate hypothesis` <span class="op">=</span> <span class="va">x_updated_h1</span><span class="op">$</span><span class="va">probability</span>,</span>
<span>                  `Null hypothesis` <span class="op">=</span> <span class="va">x_updated_h0</span><span class="op">$</span><span class="va">probability</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsDesign2</span><span class="fu">:::</span><span class="fu">table_ab</span><span class="op">(</span>table_a <span class="op">=</span> <span class="va">table_a</span>,</span>
<span>                     table_b <span class="op">=</span> <span class="va">table_b</span>,</span>
<span>                     decimals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                     byvar <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Bound <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">Bound</span>, <span class="st">"upper"</span> <span class="op">=</span> <span class="st">"Efficacy"</span>, <span class="st">"lower"</span> <span class="op">=</span> <span class="st">"Futility"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Updated design"</span>, subtitle <span class="op">=</span> <span class="st">"by event fraction based timing"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`Alternate hypothesis`</span>, <span class="va">`Null hypothesis`</span><span class="op">)</span>,</span>
<span>              label <span class="op">=</span> <span class="st">"Cumulative boundary crossing probability"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightcyan"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Efficacy"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"lightcyan"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Efficacy"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_fill.html" class="external-link">cell_fill</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F9E3D6"</span><span class="op">)</span>,</span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">Z</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">Bound</span> <span class="op">==</span> <span class="st">"Futility"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="mlojupafov" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mlojupafov table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mlojupafov thead, #mlojupafov tbody, #mlojupafov tfoot, #mlojupafov tr, #mlojupafov td, #mlojupafov th {
  border-style: none;
}

#mlojupafov p {
  margin: 0;
  padding: 0;
}

#mlojupafov .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mlojupafov .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mlojupafov .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mlojupafov .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mlojupafov .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlojupafov .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlojupafov .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlojupafov .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mlojupafov .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mlojupafov .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mlojupafov .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mlojupafov .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mlojupafov .gt_spanner_row {
  border-bottom-style: hidden;
}

#mlojupafov .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mlojupafov .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mlojupafov .gt_from_md > :first-child {
  margin-top: 0;
}

#mlojupafov .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mlojupafov .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mlojupafov .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mlojupafov .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mlojupafov .gt_row_group_first td {
  border-top-width: 2px;
}

#mlojupafov .gt_row_group_first th {
  border-top-width: 2px;
}

#mlojupafov .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlojupafov .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mlojupafov .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mlojupafov .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlojupafov .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlojupafov .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mlojupafov .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mlojupafov .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mlojupafov .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlojupafov .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlojupafov .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlojupafov .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlojupafov .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlojupafov .gt_left {
  text-align: left;
}

#mlojupafov .gt_center {
  text-align: center;
}

#mlojupafov .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mlojupafov .gt_font_normal {
  font-weight: normal;
}

#mlojupafov .gt_font_bold {
  font-weight: bold;
}

#mlojupafov .gt_font_italic {
  font-style: italic;
}

#mlojupafov .gt_super {
  font-size: 65%;
}

#mlojupafov .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mlojupafov .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mlojupafov .gt_indent_1 {
  text-indent: 5px;
}

#mlojupafov .gt_indent_2 {
  text-indent: 10px;
}

#mlojupafov .gt_indent_3 {
  text-indent: 15px;
}

#mlojupafov .gt_indent_4 {
  text-indent: 20px;
}

#mlojupafov .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal" style>Updated design</td>
    </tr>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>by event fraction based timing</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="~HR at bound">~HR at bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Nominal p">Nominal p</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <span class="gt_column_spanner">Cumulative boundary crossing probability</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null hypothesis">Null hypothesis</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64">Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">4.4166</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  ~HR at bound" class="gt_row gt_right">0.5251</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Nominal p" class="gt_row gt_right">0.0000</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Alternate hypothesis" class="gt_row gt_right">0.0104</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Null hypothesis" class="gt_row gt_right">0.0000</td>
</tr>
<tr>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Bound" class="gt_row gt_left">Futility</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Z" class="gt_row gt_right" style="background-color: #F9E3D6; font-weight: bold;">−1.0475</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  ~HR at bound" class="gt_row gt_right">1.1651</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Nominal p" class="gt_row gt_right">0.8526</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Alternate hypothesis" class="gt_row gt_right">0.0008</td>
<td headers="Analysis: 1 N: 382 Observed Events: 188 Information fraction: 0.64  Null hypothesis" class="gt_row gt_right">0.1474</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1">Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  Z" class="gt_row gt_right" style="background-color: #E0FFFF; font-weight: bold;">1.9600</td>
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  ~HR at bound" class="gt_row gt_right">0.7959</td>
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0250</td>
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9052</td>
<td headers="Analysis: 2 N: 382 Observed Events: 295 Information fraction: 1  Null hypothesis" class="gt_row gt_right">0.0250</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="arguments-of-gs_power_npe">Arguments of <code>gs_power_npe()</code><a class="anchor" aria-label="anchor" href="#arguments-of-gs_power_npe"></a>
</h3>
<p>We provide an introduction to its arguments.</p>
<ul>
<li>
<em>3 theta-related arguments</em>:
<ul>
<li>
<code>theta</code>: a vector with the natural parameter for the
group sequential design; represents expected ; <span class="math inline">\(-\log(\text{AHR})\)</span> in this case. This is
used for boundary crossing probability calculation. For example, if we
set <code>theta = 0</code>, then the crossing probability is the Type I
error.</li>
<li>
<code>theta0</code>: natural parameter for H0; used for determining
the upper (efficacy) spending and bounds. If the default of
<code>NULL</code> is given, then this is replaced by 0.</li>
<li>
<code>theta1</code>: natural parameter for H1; used for determining
the lower spending and bounds. The default is <code>NULL</code>, in
which case the value is replaced with the input <code>theta</code>.</li>
</ul>
</li>
<li>
<em>3 statistical information-related arguments</em>:
<ul>
<li>
<code>info</code>: statistical information at all analyses for input
<code>theta</code>. Default is <code>1</code>.</li>
<li>
<code>info0</code>: statistical information under H0, if different
than <code>info</code>. It impacts null hypothesis bound calculation.
Default is <code>NULL</code>.</li>
<li>
<code>info1</code>: statistical information under hypothesis used
for futility bound calculation if different from <code>info</code>. It
impacts futility hypothesis bound calculation. Default is
<code>NULL</code>.</li>
</ul>
</li>
<li>
<em>Efficacy/Futility boundary-related arguments</em>:
<ul>
<li>
<code>upper</code>, <code>upar</code> and <code>test_upper</code>:
efficacy bounds related, same as <code><a href="../reference/gs_design_ahr.html">gs_design_ahr()</a></code>.</li>
<li>
<code>lower</code>, <code>lpar</code> and <code>test_lower</code>:
futility bounds related, same as <code><a href="../reference/gs_design_ahr.html">gs_design_ahr()</a></code>.</li>
<li>
<code>binding</code>: <code>TRUE</code> or <code>FALSE</code>
indicating whether it is binding or non-binding designs.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="statistical-information-under-h0">Statistical information under H0<a class="anchor" aria-label="anchor" href="#statistical-information-under-h0"></a>
</h3>
<p>In this section, we discuss the values of the <code>info</code>
arguments for the input <code>theta = 0</code> of
<code>gs_power_npe</code>. Since the statistical information is
event-based, and <code>theta = 0</code> (null hypothesis), the observed
statistical information under null hypothesis is</p>
<p><span class="math display">\[
  \text{observed number of events} \times \frac{r}{1 + r} \times
\frac{1}{1 + r},
\]</span></p>
<p>where <span class="math inline">\(r\)</span> is the randomization
ratio (experimental : control). In this example, the observed
statistical information is calculated as
<code>info = event_observed / 4</code>, and thus, we input 18.75, 18.75
for the <code>info</code> argument. In this case, we retain the default
imputed value for <code>info0</code>, which is set as <code>info</code>.
The <code>info</code> represents the statistical information under the
null hypothesis (<code>theta = 0</code>). Furthermore, we leave
<code>info1</code> as it is, considering our focus on efficacy bounds,
while noting that <code>info1</code> does affect the futility
bounds.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lan1983discrete" class="csl-entry">
Lan, K. K. Gordon, and David L DeMets. 1983. <span>“Discrete Sequential
Boundaries for Clinical Trials.”</span> <em>Biometrika</em> 70 (3):
659–63.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keaven Anderson, Yilong Zhang, Yujie Zhao, Jianxiao Yang, Nan Xiao. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7. <br>Copyright © 2024 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><span></span></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
