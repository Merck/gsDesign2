<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gsDesign2">
<title>Group Sequential Design for Binary Outcomes • gsDesign2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Group Sequential Design for Binary Outcomes">
<meta property="og:description" content="gsDesign2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsDesign2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LittleBeannie/gsDesign2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="story_risk_difference_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Group Sequential Design for Binary Outcomes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LittleBeannie/gsDesign2/blob/HEAD/vignettes/story_risk_difference.Rmd" class="external-link"><code>vignettes/story_risk_difference.Rmd</code></a></small>
      <div class="d-none name"><code>story_risk_difference.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>We consider group sequential design examining the risk difference between two treatment groups for a binary outcome. There are several issues to consider:</p>
<ul>
<li>The measure of treatment difference or natural parameter; we focus on risk difference.</li>
<li>Incorporation of both null and alternate hypothesis variances.</li>
<li>Superiority, non-inferiority and super-superiority designs.</li>
<li>Stratified populations.</li>
<li>Fixed and group sequential designs.</li>
</ul>
<p>For single stratum designs, we focus on sample size or power using the method of <span class="citation">Farrington and Manning (1990)</span> for a trial to test the difference between two binomial event rates. The routine can be used for a test of superiority, non-inferiority or super-superiority. For a design that tests for superiority, the methods are consistent with those of <span class="citation">Fleiss, Tytun, and Ury (1980)</span>, but without the continuity correction. Methods for sample size and power are the same as <code><a href="https://keaven.github.io/gsDesign/reference/varBinomial.html" class="external-link">gsDesign::nBinomial()</a></code> when testing on the risk-difference scale for a single stratum. This is also consistent with the <strong>Hmisc</strong> R package routines <code>bsamsize()</code> and <code>bpower()</code> for superiority designs.</p>
<p>For trials with multiple strata, testing for a risk difference is often done by weighting each stratum according to the inverse of the variance (<span class="citation">Mantel and Haenszel (1959)</span>). Since risk differences may also be assumed to be different for different strata, we will also explore weighting by strata sample sizes as in <span class="citation">Mehrotra and Railkar (2000a)</span>.</p>
<p>The focus here is for sample sizes that are large enough for asymptotic theory to work well without continuity corrections. The concepts are incorporated in the following functions intended for use in fixed and group sequential designs:</p>
<ul>
<li>
<code><a href="../reference/gs_info_rd.html">gs_info_rd()</a></code> to support asymptotic variance and statistical information calculation.</li>
<li>
<code><a href="../reference/gs_power_rd.html">gs_power_rd()</a></code> to support power calculations.</li>
<li>
<code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code> to support sample size calculations.</li>
</ul>
<p>Simulation is used throughout to check the examples presented.</p>
</div>
<div class="section level2">
<h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h2>
<ul>
<li><p><span class="math inline">\(K\)</span>: total number of analyses (including the final analysis) in the group sequential design. For fixed design, <span class="math inline">\(K= 1\)</span>.</p></li>
<li><p><span class="math inline">\(S\)</span>: total number of strata. If the population is un-stratified population, then <span class="math inline">\(S=1\)</span>.</p></li>
<li><p><span class="math inline">\(w_{s,k}\)</span>: the <strong>underlying</strong> weight assigned for the <span class="math inline">\(s\)</span>-th strata at the <span class="math inline">\(k\)</span>-th analysis. WHY SWITH ORDER OF s, k FROM w?</p></li>
<li><p><span class="math inline">\(\widehat w_{s,k}\)</span>: the <strong>estimated</strong> weight assigned for the <span class="math inline">\(s\)</span>-th strata at the <span class="math inline">\(k\)</span>-th analysis.</p></li>
<li><p><span class="math inline">\(N_{C,k,s}, N_{E,k,s}\)</span>: the <strong>planned</strong> sample size in the control/treatment group at the <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata.</p></li>
<li><p><span class="math inline">\(\widehat N_{C,k,s}, \widehat N_{E,k,s}\)</span>: the <strong>observed</strong> sample size in the control/treatment group at the <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata.</p></li>
<li><p><span class="math inline">\(r\)</span>: <strong>planned</strong> randomization ratio, i.e., <span class="math display">\[
r = N_{E,k,s} / N_{C,k,s} \;\; \forall k = 1, \ldots, K \;\; \text{and} \;\; s = 1, \ldots, S.
\]</span></p></li>
<li><p><span class="math inline">\(p_{C,s}, p_{E,s}\)</span>: the <strong>planned</strong> rate of the control/treatment arm, i.e., the independent observations in the control/treatment group with a binary outcome that is observed with probability <span class="math inline">\(p_{C,s}\)</span> at any <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata.</p></li>
<li><p><span class="math inline">\(d\)</span>: an indicator whether is an outcome is failure (bad outcome) or response (good outcome), i.e., <span class="math display">\[
d
= 
\left\{
\begin{array}{lll}
  -1 &amp; \text{if } p_{C,s} &lt; p_{E,s} &amp; \text{the control arm is better}\\
   1 &amp; \text{if } p_{C,s} &gt; p_{E,s} &amp; \text{the treatment arm is better}\\
\end{array}
\right.
\]</span> Here we assume if <span class="math inline">\(\exists s^* \in \{1, \ldots, S\}\)</span>, s.t., <span class="math inline">\(p_{C,s^*} &lt; p_{E,s^*}\)</span>, then <span class="math inline">\(p_{C,s} &lt; p_{E,s}, \forall s \in \{1, \ldots, S\}\)</span>, and vice versa.</p></li>
<li><p><span class="math inline">\(X_{C,k,s}, X_{E,k,s}\)</span>: random variables indicating the number of subjects failed in control/treatment arm, i.e., <span class="math inline">\(X_{C,k,s} \sim \hbox{Binomial}(N_{C,k,s}, p_{C,k,s})\)</span>, <span class="math inline">\(X_{E,k,s} \sim \hbox{Binomial}(N_{E,k,s}, p_{E,k,s})\)</span> at the <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata.</p></li>
<li><p><span class="math inline">\(x_{C,k,s}, x_{E,k,s}\)</span>: the observed outcome of <span class="math inline">\(X_{C, k, s}, X_{E, k, s}\)</span> at the <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata, respectively.</p></li>
<li><p><span class="math inline">\(\widehat p_{C,k,s}, \widehat p_{E,k,s}\)</span>: observed rates of the control/treatment group at the <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata, i.e., <span class="math display">\[
\widehat p_{C,k,s} = x_{C,k,s} / \widehat N_{C,k,s}.\\
\widehat p_{E,k,s} = x_{E,k,s} / \widehat N_{E,k,s}.
\]</span></p></li>
<li><p><span class="math inline">\(\delta_{s}^{null}\)</span>: the <strong>planned</strong> risk difference under <span class="math inline">\(H_0\)</span> at any <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata.</p></li>
<li><p><span class="math inline">\(\delta_{s}\)</span>: the <strong>planned</strong> risk difference under <span class="math inline">\(H_1\)</span> at any <span class="math inline">\(k\)</span>-th analysis of the <span class="math inline">\(s\)</span>-th strata is denoted by <span class="math display">\[
\delta_{s} = |p_{C,s} - p_{E,s}|. 
\]</span></p></li>
<li><p><span class="math inline">\(\hat\delta_{s}\)</span>: estimation of risk difference with <span class="math display">\[
\widehat\theta_{k,s} = |\widehat p_{C,k,s} - \widehat p_{E,k,s}|
\]</span> We have <span class="math inline">\(E(\widehat\theta_{k,s}) = \theta_{s}, \;\forall k = 1, \ldots, K\)</span>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h2>
<p>The test statistics at the <span class="math inline">\(k\)</span>-th analysis is <span class="math display">\[
  Z_{k} 
  = 
  \frac{ 
    \sum_{s=1}^S \widehat w_{s,k} \; |\widehat \delta_{k,s} - \delta_{s}^{null} |
  }{
    \sqrt{\sum_{s=1}^S \widehat w_{s,k}^2 \widehat\sigma_{H_0,k,s}^2}
  }
\]</span> where <span class="math inline">\(\widehat\sigma^2_{k,s} = \widehat{\hbox{Var}}(\widehat p_C -\widehat p_E)\)</span>. And the value of <span class="math inline">\(\widehat\sigma^2_{k,s}\)</span> depends on the hypothesis and design, i.e., whether it is a superiority design, or non-inferiority design, or super-superiority design. We will discuss <span class="math inline">\(\widehat\sigma^2_{k,s}\)</span> in the following 3 subsections.</p>
<div class="section level3">
<h3 id="superiority-design">Superiority Design<a class="anchor" aria-label="anchor" href="#superiority-design"></a>
</h3>
<p>A superiority design (<span class="math inline">\(\delta_{s}^{null} = 0\)</span>) is to show that experimental group is superior to the control group above some thresholds. Its hypothesis is <span class="math display">\[
  H_0: \delta_{s} = 0 \text{ vs. } H_1: \delta_{s} &gt; 0, \; \forall k = 1, \ldots, K, s = 1, \ldots, S
\]</span></p>
<ul>
<li>
<p><strong>Variance per strata per analysis:</strong></p>
<ul>
<li><p>Under the null hypothesis, we have <span class="math display">\[
\begin{array}{ll}
\sigma^2_{H_0,k,s} 
&amp; = 
\text{Var}(p_C - p_E | H_0)
=
p_{k,s}^{pool} \left(1 - p^{pool}_{k,s} \right) \left(\frac{1}{N_{C,k,s}} + \frac{1}{N_{E,k,s}} \right), \\
\widehat\sigma^2_{H_0,k,s} 
&amp; = 
\widehat{\text{Var}}(\hat p_C - \hat p_E | H_0)
=
\widehat p_{k,s}^{pool} \left(1 - \widehat p^{pool}_{k,s} \right) \left(\frac{1}{N_{C,k,s}} + \frac{1}{N_{E,k,s}} \right),
\end{array}
\]</span> where <span class="math inline">\(p_{k,s}^{pool} = (p_{C,s} N_{C,k,s} + p_{E,s} N_{E,k,s}) / (N_{C,k,s} + N_{E,k,s})\)</span> and <span class="math inline">\(\widehat p_{k,s}^{pool} = (x_{C,k,s} + x_{E,k,s}) / (\widehat N_{C,k,s} + \widehat N_{E,k,s}).\)</span></p></li>
<li><p>Under the alternative hypothesis, we have <span class="math display">\[
\begin{array}{ll}
\sigma_{H_1,k,s}^2 
&amp; = 
\text{Var}(p_C - p_E | H_1)
= 
\frac{p_{C,s} (1- p_{C,s})}{N_{C,k,s}} + \frac{p_{E,s} (1 - p_{E,s})}{N_{E,k,s}} \\
\widehat\sigma_{H_1,k,s}^2 
&amp; = 
\widehat{\text{Var}}(\hat p_C - \hat p_E | H_1)
= 
\frac{\widehat p_{C,k,s} (1- \widehat p_{C,k,s})}{N_{C,k,s}} + \frac{\widehat p_{E,k,s} (1 - \widehat p_{E,k,s})}{N_{E,k,s}}
\end{array}
\]</span> where <span class="math inline">\(\widehat p_{C,k,s} = x_{C,k,s} / N_{C,k,s} \text{ and } \widehat p_{E,k,s} = x_{E,k,s} / N_{E,k,s}\)</span>. Testing will be one-sided at level <span class="math inline">\(\alpha \in (0, 1)\)</span> and the null hypothesis will be rejected if <span class="math inline">\(Z_k\)</span> cross the upper boundary. And the upper boundary can be either fixed or derived from spending functions.</p></li>
</ul>
</li>
<li>
<p><strong>Standardized treatment effect per analysis:</strong></p>
<ul>
<li><p>Under the null hypothesis, we have <span class="math display">\[
\theta_{H_0,k} = 0 \\
\widehat \theta_{H_0,k} = 0
\]</span></p></li>
<li><p>Under the alternative hypothesis, we have <span class="math display">\[
\begin{array}{ll}
\theta_{H_1,k} 
&amp; = \frac{\sum_{s=1}^S w_{k,s} (p_{C,s} - p_{E,s})}{\sqrt{\sum_{s=1}^S w_{k,s}^2 \sigma_{H_1, k,s}^2}}\\
\widehat\theta_{H_1,k} 
&amp; = 
\frac{
\sum_{s=1}^S \widehat w_{k,s} (\widehat p_C - \widehat p_E)
}{
\sqrt{\sum_{s=1}^S \widehat w_{k,s}^2 \widehat\sigma_{H_1, k,s}^2}
}.
\end{array}
\]</span></p></li>
</ul>
</li>
<li>
<p><strong>Standardized information per analysis:</strong></p>
<p><span class="citation">Lachin (2009)</span> or <span class="citation">Lachin (1981)</span> provide fixed sample size calculations based on the values <span class="math inline">\(\psi_0\)</span> under the null hypothesis and <span class="math inline">\(\psi_1\)</span> under the alternate hypothesis. Here we propose using the same variance calculations to compute statistical information for a group sequential design and apply the formulation for power and sample size calculation in the vignette <em>Computing Bounds Under Non-Constant Treatment Effect</em>.</p>
<ul>
<li><p>Under the null hypothesis, we have <span class="math display">\[
\begin{array}{ll}
\mathcal I_{H0,k} 
&amp; = 
\left[ 
\sum_{s=1}^S 
w_{k,s}^2 \frac{p_{k,s}^{pool} (1 - p_{k,s}^{pool})}{N_{C, k, s}} + 
w_{k,s}^2 \frac{p_{k,s}^{pool} (1 - p_{k,s}^{pool})}{N_{E, k, s}} 
\right]^{-1} \\
\widehat{\mathcal I}_{H0,k} 
&amp; = 
\left[ 
\sum_{s=1}^S 
\widehat w_{k,s}^2 \frac{\widehat p_{k,s}^{pool} (1 - \widehat p_{k,s}^{pool})}{\widehat N_{C,k,s}} +
\widehat w_{k,s}^2 \frac{\widehat p_{k,s}^{pool} (1 - \widehat p_{k,s}^{pool})}{\widehat N_{C,k,s}} 
\right]^{-1}
\end{array}
\]</span></p></li>
<li><p>Under the alternative hypothesis, we have <span class="math display">\[
\begin{array}{ll}
\mathcal I_{H1,k}
= 
\left[ 
\sum_{s=1}^S w_{k,s}^2 \frac{p_{C,k,s} (1 - p_{C,k,s})}{N_{C,k,s}}
+
\sum_{s=1}^S w_{k,s}^2 \frac{p_{E,k,s} (1 - p_{E,k,s})}{N_{E,k,s}} 
\right]^{-1}\\
\widehat{\mathcal I}_{H1,k} 
= 
\left[ 
\sum_{s=1}^S \widehat w_{k,s}^2 \frac{\widehat p_{C,k,s} (1 - \widehat p_{C,k,s})}{\widehat N_{C,k,s}}
+
\sum_{s=1}^S \widehat w_{k,s}^2 \frac{\widehat p_{E,k,s} (1 - \widehat p_{E,k,s})}{\widehat N_{E,k,s}} 
\right]^{-1}
\end{array}
\]</span></p></li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="super-superiority-design">Super-Superiority Design<a class="anchor" aria-label="anchor" href="#super-superiority-design"></a>
</h3>
<p>The hypothesis of the super-superiority design is</p>
<p><span class="math display">\[
  H_0: \delta_{k,s} = \delta_{k,s}^{null} 
  \;\; vs. \;\; 
  H_1: \delta &gt; \delta_{k,s}^{null} \text{ with } \delta_{k,s}^{null} &gt; 0.
\]</span> Here <span class="math inline">\(\theta_{k,s_1}^{null} = \theta_{k,s_2}^{null}\)</span> or <span class="math inline">\(\theta_{k,s_1}^{null} \neq \theta_{k,s_2}^{null}\)</span> for <span class="math inline">\(s_1 \neq s_2\)</span>.</p>
<p>Under the null hypothesis <span class="math inline">\(\theta_{0,k,s} \neq 0\)</span>, the estimation of rates <span class="math inline">\(\widehat p_{C0,k,s}, \widehat p_{E0,k,s}\)</span> satisfy <span class="math display">\[
  \left\{
  \begin{array}{l}
    \widehat p_{C0,k,s} = \widehat p_{E0,k,s} + d_{k,s} \times \delta_{k,s}^{null} \\
    \widehat p_{C0,k,s} + r\widehat p_{E0,k,s} = \widehat p_{C,k,s} + r\widehat p_{E,k,s} .
  \end{array}
  \right.
\]</span> Solving these 2 equations with 2 unknowns yields <span class="math display">\[
  \left\{
  \begin{array}{l}
  \widehat p_{E0,k,s} &amp; = (\widehat p_{C,k,s} + r \widehat p_{E,k,s} - d_{k,s} \delta_{k,s}^{null}) / (r + 1)\\
  \widehat p_{C0,k,s} &amp; =  \widehat p_{E0,k,s} + d_{k,s} \delta_{k,s}^{null}.
  \end{array}
  \right.
\]</span></p>
<ul>
<li>
<p><strong>Variance per strata per analysis:</strong></p>
<ul>
<li>Under <span class="math inline">\(H_0\)</span>, we have</li>
</ul>
</li>
</ul>
<p><span class="math display">\[
  \hat\sigma^2_{H_0,k,s}
  = 
  \frac{\widehat p_{C0,k,s}(1- \widehat p_{C0,k,s})}{N_{C,k,s}} + \frac{ \widehat p_{E0,k,s} (1 - \widehat p_{E0,k,s})}{N_{E,k,s}}.
\]</span></p>
<ul>
<li>Under <span class="math inline">\(H_1\)</span>, we have</li>
</ul>
<p><span class="math display">\[
  \widehat\sigma_{H_1,k,s}^2 
  = 
  \frac{\widehat p_{C,k,s} (1- \widehat p_{C,k,s})}{N_{C,k,s}} + \frac{\widehat p_{E,k,s} (1 - \widehat p_{E,k,s})}{N_{E,k,s}}.
\]</span></p>
<ul>
<li>
<p><strong>Standardized treatment effect per analysis:</strong></p>
<ul>
<li>Under the null hypothesis, we have</li>
</ul>
</li>
</ul>
<p><span class="math display">\[
  \widehat \theta_{H_0,k} 
  = 
  \frac{
    \sum_{s=1}^S w_{k,s} \delta_{s,k}^{null}
  }{
    \sqrt{\sum_{s=1}^S w_{k,s}^2 \widehat \sigma_{H_0,k,s}}^2
  }.
\]</span></p>
<ul>
<li>Under the alternative hypothesis, we have</li>
</ul>
<p><span class="math display">\[
  \widehat \theta_{H_1} 
  = 
  \frac{
    \sum_{s=1}^S w_{k,s} d_{k,s} \times (\widehat p_{C,k,s} - \widehat p_{E,k,s})
  }{
    \sqrt{\sum_{s=1}^S w_{k,s}^2 \widehat \sigma_{H_1,k,s}^2}
  }.
\]</span></p>
<ul>
<li>
<p><strong>Standardized information per analysis:</strong></p>
<ul>
<li>Under the null hypothesis, we have</li>
</ul>
</li>
</ul>
<p><span class="math display">\[
  \widehat{\mathcal I}_{H0,k} 
  = 
  \left[ 
  \sum_{s=1}^S w_{k,s}^2 \frac{\bar p_{C0,s} (1 - \bar p_{C0,s})}{N_{C,s}} + w_{k,s}^2\frac{\bar p_{E0,s} (1 - \bar p_{E0,s})}{N_{E,s}} 
  \right]^{-1}.
\]</span></p>
<ul>
<li>Under the alternative hypothesis, we have</li>
</ul>
<p><span class="math display">\[
  \widehat{\mathcal I}_{H1,k} 
  = 
  \left[
  \sum_{s=1}^S \left( w_{k,s}^2 \frac{\bar p_{C,k,s} (1 - \bar p_{C,k,s})}{N_{C,k,s}} + w_{k,s}^2 \frac{\bar p_{E,k,s} (1 - \bar p_{E,k,s})}{N_{E,k,s}} \right)
  \right]^{-1}.
\]</span></p>
</div>
<div class="section level3">
<h3 id="non-inferiority-design">Non-inferiority Design<a class="anchor" aria-label="anchor" href="#non-inferiority-design"></a>
</h3>
<p>The non-inferiority Design means that, while the treatment group is definitely not better than the control group, it is not unacceptably worse. Its hypothesis is <span class="math inline">\(H_0: \delta_{k,s} = \delta_{k,s}^{null} \;\; vs. \;\; H_1: \delta_{k,s} &gt; \delta_{k,s}^{null}\)</span> with <span class="math inline">\(\delta_{k,s}^{null} &lt;0\)</span>. Its variance, standardized treatment effect and statistical information is the same as that from super-superiority design by setting <span class="math inline">\(\delta_{k,s}^{null}\)</span> as negative numbers.</p>
</div>
</div>
<div class="section level2">
<h2 id="weighting-options">Weighting Options<a class="anchor" aria-label="anchor" href="#weighting-options"></a>
</h2>
<p>As previously noted, we will consider weighting based on either inverse-variance weights (<span class="citation">Mantel and Haenszel (1959)</span>) or strata sample size weights (<span class="citation">Mehrotra and Railkar (2000b)</span>).</p>
<ul>
<li><p><strong>Inverse-variance weights (INVAR):</strong> <span class="math display">\[
w_{s,k} = \frac{1/\sigma^2_{s,k}}{\sum_{s=1}^S 1/\sigma^2_{s,k}}. \\
\widehat w_{s,k} = \frac{1/\widehat\sigma^2_{s,k}}{\sum_{s=1}^S 1/\widehat\sigma^2_{s,k}}.
\]</span> where <span class="math inline">\(\widehat\sigma_{s,k}^2 \in \{\widehat\sigma_{H_0, k,s}^2, \widehat\sigma_{H_1, k,s}^2 \}\)</span> depending on the infomation scale <code>info_scale = ...</code> in <code><a href="../reference/gs_info_rd.html">gs_info_rd()</a></code>, <code><a href="../reference/gs_power_rd.html">gs_power_rd()</a></code> and <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code>.</p></li>
<li><p><strong>Sample-Size Weights (SS):</strong> <span class="math display">\[
w_{s,k} 
=
\frac{
  (N_{C, s, k} \; N_{E, s, k}) / (N_{C, s, k} + N_{E, s, k})
}{
  \sum_{s=1}^S (N_{C, s, k} \; N_{E, s, k}) / (N_{C, s, k} + N_{E, s, k})
},\\
\widehat w_{s,k} 
=
\frac{
  (\widehat N_{C, s, k} \; \widehat N_{E, s, k}) / (\widehat N_{C, s, k} + \widehat N_{E, s, k})
}{
  \sum_{s=1}^S (\widehat N_{C, s, k} \; \widehat N_{E, s, k}) / (\widehat N_{C, s, k} + \widehat N_{E, s, k})
},
\]</span> where <span class="math inline">\(N_{C,s,k}, N_{E,s,k}\)</span> are the planned sample size of the <span class="math inline">\(s\)</span>-th strata and <span class="math inline">\(k\)</span>-th analysis of the control group and experimental group, respectively. And <span class="math inline">\(\widehat N_{C,s,k}, \widehat N_{E,s,k}\)</span> are the observed sample size of the <span class="math inline">\(s\)</span>-th strata and <span class="math inline">\(k\)</span>-th analysis of the control group and experimental group, respectively.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>We do a quick 20,000 simulations and compare the density histogram of outcomes to the standard normal density. Assume <span class="math inline">\(r=1, d = 1, p_C=p_E=0.125, N=200\)</span>. We then compute <span class="math inline">\(\sigma\)</span> as 0.047. Even for this <em>not huge</em> sample size the normal density fits quite well other than some flatness in the middle.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hypothesized failure rate</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">.125</span></span>
<span><span class="co">#  Other parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">NC</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">/</span> <span class="op">(</span><span class="va">r</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">NE</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="va">N</span> <span class="op">/</span> <span class="op">(</span><span class="va">r</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Generate random counts of events for each treatment</span></span>
<span><span class="va">xC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20000</span>, size <span class="op">=</span> <span class="va">NC</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">xE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20000</span>, size <span class="op">=</span> <span class="va">NE</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="co"># Treatment difference estimate</span></span>
<span><span class="va">thetahat</span> <span class="op">&lt;-</span> <span class="va">xC</span> <span class="op">/</span> <span class="va">NC</span> <span class="op">-</span> <span class="va">xE</span> <span class="op">/</span> <span class="va">NE</span></span>
<span><span class="co"># Standard error under H0</span></span>
<span><span class="va">pbar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xC</span> <span class="op">+</span> <span class="va">xE</span><span class="op">)</span> <span class="op">/</span> <span class="va">N</span></span>
<span><span class="va">se0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pbar</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pbar</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">NC</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">NE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Z to test H0</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">thetahat</span> <span class="op">/</span> <span class="va">se0</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">se0a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">NC</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">NE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="va">x</span>, Density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Z</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, color <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Z</span>, y <span class="op">=</span> <span class="va">Density</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Binomial outcomes by simulation vs. asymptotic normal density"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"Histogram of 20,000 simulations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="story_risk_difference_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="unstratified-fixed-design">Unstratified Fixed Design<a class="anchor" aria-label="anchor" href="#unstratified-fixed-design"></a>
</h3>
<p>The example discussed in this section is an unstratified fixed design with equal sized groups to detect a 30% reduction in mortality associated with congestive heart failure, where the 1-year mortality in the control group is assumed to be no greater than 0.4. So <span class="math inline">\(p_C=0.4, p_E = .28\)</span>. Under the null hypothesis, we assume <span class="math inline">\(p_C=p_E =0.34\)</span>. We desire 90% power for a two-sided test for two proportions at <span class="math inline">\(\alpha = 0.05\)</span>. And we would like to calculate the sample size to achieve the 90% power.</p>
<div class="section level4">
<h4 id="gsdesign2">
<code>gsDesign2</code><a class="anchor" aria-label="anchor" href="#gsdesign2"></a>
</h4>
<p>First, we set the parameters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_c</span> <span class="op">&lt;-</span> <span class="fl">.28</span></span>
<span><span class="va">p_e</span> <span class="op">&lt;-</span> <span class="fl">.4</span></span>
<span><span class="va">p_pool</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_c</span> <span class="op">+</span> <span class="va">p_e</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">N_c</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ratio</span><span class="op">)</span></span>
<span><span class="va">N_e</span> <span class="op">&lt;-</span> <span class="va">N_c</span> <span class="op">*</span> <span class="va">ratio</span></span></code></pre></div>
<p>Then we calculate the variance under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>. Their mathmatical formulation are shown as follows. <span class="math display">\[
  \begin{array}{ll}
  \sigma^2_{H_0} 
  =
  p^{pool} \left(1 - p^{pool} \right) \left(\frac{1}{N_C} + \frac{1}{N_{E}} \right)
  =
  p^{pool} \left(1 - p^{pool} \right) \left(\frac{1}{N \xi_C} + \frac{1}{N \xi_E} \right)
  \overset{r=1}{=}
  p^{pool} \left(1 - p^{pool} \right) \frac{4}{N} \\
  \sigma^2_{H_1} 
  =
  \frac{p_C \left(1 - p_C \right)}{N_C} +
  \frac{p_E \left(1 - p_E \right)}{N_E}
  =
  \frac{p_C \left(1 - p_C \right)}{N \xi_C} +
  \frac{p_E \left(1 - p_E \right)}{N \xi_E} 
  \overset{r=1}{=}
  \left[
    p_C \left(1 - p_C \right) +
    p_E \left(1 - p_E \right)
  \right] \frac{2}{N}
  \end{array}
\]</span> And their calculation results are</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_H0</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">/</span> <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">sigma_H1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_c</span><span class="op">)</span> <span class="op">+</span> <span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">N</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info_H0</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">sigma_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">info_H1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">sigma_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Next, we calculate the standarized treatment effect under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>, whose mathmatical formulation are <span class="math display">\[
  \begin{array}{ll}
  \theta_{H_0} = 0; \\
  \theta_{H_1} = \frac{|p_c - p_e|}{\sigma_{H_1}}
  \end{array}.
\]</span></p>
<p>And their calculation results are</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_H0</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">theta_H1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">sigma_H1</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">N_c</span>, <span class="op">~</span><span class="va">N_e</span>, <span class="op">~</span><span class="va">p_c</span>,    <span class="op">~</span><span class="va">p_e</span>,   <span class="op">~</span><span class="va">theta_H1</span>,    <span class="op">~</span><span class="va">theta_H0</span>,    <span class="op">~</span><span class="va">info_H1</span>,    <span class="op">~</span><span class="va">info_H0</span>,</span>
<span>   <span class="va">N_c</span>,  <span class="va">N_e</span>,  <span class="va">p_c</span>,     <span class="va">p_e</span>,    <span class="va">theta_H1</span>,     <span class="va">theta_H0</span>,     <span class="va">info_H1</span>,     <span class="va">info_H0</span>,</span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="vkhoiuwygc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vkhoiuwygc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vkhoiuwygc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkhoiuwygc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vkhoiuwygc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vkhoiuwygc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkhoiuwygc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkhoiuwygc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vkhoiuwygc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vkhoiuwygc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vkhoiuwygc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vkhoiuwygc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vkhoiuwygc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vkhoiuwygc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vkhoiuwygc .gt_from_md > :first-child {
  margin-top: 0;
}

#vkhoiuwygc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vkhoiuwygc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vkhoiuwygc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vkhoiuwygc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vkhoiuwygc .gt_row_group_first td {
  border-top-width: 2px;
}

#vkhoiuwygc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkhoiuwygc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vkhoiuwygc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vkhoiuwygc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkhoiuwygc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkhoiuwygc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vkhoiuwygc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vkhoiuwygc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkhoiuwygc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkhoiuwygc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkhoiuwygc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkhoiuwygc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkhoiuwygc .gt_left {
  text-align: left;
}

#vkhoiuwygc .gt_center {
  text-align: center;
}

#vkhoiuwygc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vkhoiuwygc .gt_font_normal {
  font-weight: normal;
}

#vkhoiuwygc .gt_font_bold {
  font-weight: bold;
}

#vkhoiuwygc .gt_font_italic {
  font-style: italic;
}

#vkhoiuwygc .gt_super {
  font-size: 65%;
}

#vkhoiuwygc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vkhoiuwygc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vkhoiuwygc .gt_indent_1 {
  text-indent: 5px;
}

#vkhoiuwygc .gt_indent_2 {
  text-indent: 10px;
}

#vkhoiuwygc .gt_indent_3 {
  text-indent: 15px;
}

#vkhoiuwygc .gt_indent_4 {
  text-indent: 20px;
}

#vkhoiuwygc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta_H1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta_H0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_H1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_H0</th>
    </tr></thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right">0.5</td>
<td class="gt_row gt_right">0.5</td>
<td class="gt_row gt_right">0.28</td>
<td class="gt_row gt_right">0.4</td>
<td class="gt_row gt_right">0.1276885</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1.132246</td>
<td class="gt_row gt_right">1.114082</td>
</tr></tbody>
</table>
</div>
<p>The above logic is implemented in teh function <code><a href="../reference/gs_info_rd.html">gs_info_rd()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_info_rd.html">gs_info_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.28</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, N <span class="op">=</span> <span class="fl">1</span>, Analysis <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, decimals <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div id="srhogpzmea" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#srhogpzmea .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#srhogpzmea .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srhogpzmea .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#srhogpzmea .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#srhogpzmea .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhogpzmea .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srhogpzmea .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#srhogpzmea .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#srhogpzmea .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#srhogpzmea .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#srhogpzmea .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#srhogpzmea .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#srhogpzmea .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#srhogpzmea .gt_from_md > :first-child {
  margin-top: 0;
}

#srhogpzmea .gt_from_md > :last-child {
  margin-bottom: 0;
}

#srhogpzmea .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#srhogpzmea .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#srhogpzmea .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#srhogpzmea .gt_row_group_first td {
  border-top-width: 2px;
}

#srhogpzmea .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhogpzmea .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#srhogpzmea .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#srhogpzmea .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhogpzmea .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhogpzmea .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#srhogpzmea .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#srhogpzmea .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhogpzmea .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srhogpzmea .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhogpzmea .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srhogpzmea .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhogpzmea .gt_left {
  text-align: left;
}

#srhogpzmea .gt_center {
  text-align: center;
}

#srhogpzmea .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#srhogpzmea .gt_font_normal {
  font-weight: normal;
}

#srhogpzmea .gt_font_bold {
  font-weight: bold;
}

#srhogpzmea .gt_font_italic {
  font-style: italic;
}

#srhogpzmea .gt_super {
  font-size: 65%;
}

#srhogpzmea .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#srhogpzmea .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#srhogpzmea .gt_indent_1 {
  text-indent: 5px;
}

#srhogpzmea .gt_indent_2 {
  text-indent: 10px;
}

#srhogpzmea .gt_indent_3 {
  text-indent: 15px;
}

#srhogpzmea .gt_indent_4 {
  text-indent: 20px;
}

#srhogpzmea .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info0</th>
    </tr></thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.12</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.127688</td>
<td class="gt_row gt_right">0.000000</td>
<td class="gt_row gt_right">1.132246</td>
<td class="gt_row gt_right">1.114082</td>
</tr></tbody>
</table>
</div>
<p>By plugging the <code>theta</code> and <code>info</code> above into <code><a href="../reference/gs_design_npe.html">gs_design_npe()</a></code>, one can calculate the sample size to achieve the 90% power.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># under info_scale = 0</span></span>
<span><span class="va">y_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.4</span> <span class="op">-</span> <span class="fl">.28</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># under info_scale = 1</span></span>
<span><span class="va">y_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.4</span> <span class="op">-</span> <span class="fl">.28</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># under info_scale = 2</span></span>
<span><span class="va">y_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.4</span> <span class="op">-</span> <span class="fl">.28</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>par <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>`info_scale = 0` <span class="op">=</span> <span class="va">y_0</span><span class="op">$</span><span class="va">info0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>       `info_scale = 1` <span class="op">=</span> <span class="va">y_1</span><span class="op">$</span><span class="va">info1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>       `info_scale = 2` <span class="op">=</span> <span class="va">y_2</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The sample size calculated by gsDesign2 under 3 info_scale"</span><span class="op">)</span></span></code></pre></div>
<div id="dmcrkrqrkf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dmcrkrqrkf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dmcrkrqrkf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmcrkrqrkf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dmcrkrqrkf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dmcrkrqrkf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmcrkrqrkf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmcrkrqrkf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dmcrkrqrkf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dmcrkrqrkf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dmcrkrqrkf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dmcrkrqrkf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dmcrkrqrkf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dmcrkrqrkf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dmcrkrqrkf .gt_from_md > :first-child {
  margin-top: 0;
}

#dmcrkrqrkf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dmcrkrqrkf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dmcrkrqrkf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dmcrkrqrkf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dmcrkrqrkf .gt_row_group_first td {
  border-top-width: 2px;
}

#dmcrkrqrkf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmcrkrqrkf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dmcrkrqrkf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dmcrkrqrkf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmcrkrqrkf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmcrkrqrkf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dmcrkrqrkf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dmcrkrqrkf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmcrkrqrkf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmcrkrqrkf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmcrkrqrkf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmcrkrqrkf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmcrkrqrkf .gt_left {
  text-align: left;
}

#dmcrkrqrkf .gt_center {
  text-align: center;
}

#dmcrkrqrkf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dmcrkrqrkf .gt_font_normal {
  font-weight: normal;
}

#dmcrkrqrkf .gt_font_bold {
  font-weight: bold;
}

#dmcrkrqrkf .gt_font_italic {
  font-style: italic;
}

#dmcrkrqrkf .gt_super {
  font-size: 65%;
}

#dmcrkrqrkf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dmcrkrqrkf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dmcrkrqrkf .gt_indent_1 {
  text-indent: 5px;
}

#dmcrkrqrkf .gt_indent_2 {
  text-indent: 10px;
}

#dmcrkrqrkf .gt_indent_3 {
  text-indent: 15px;
}

#dmcrkrqrkf .gt_indent_4 {
  text-indent: 20px;
}

#dmcrkrqrkf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>The sample size calculated by gsDesign2 under 3 info_scale</td>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
    </tr></thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right">654.9627</td>
<td class="gt_row gt_right">644.4553</td>
<td class="gt_row gt_right">650.7984</td>
</tr></tbody>
</table>
</div>
<p>The above logic is implement in <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code> to calculate the sample size given fixed power in one-step.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z_info_scale_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.28</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,   </span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,   </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">z_info_scale_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.28</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,   </span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,   </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z_info_scale_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.28</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,   </span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,   </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>  lpar <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gsdesign">
<code>gsDesign</code><a class="anchor" aria-label="anchor" href="#gsdesign"></a>
</h4>
</div>
<div class="section level4">
<h4 id="east">EAST<a class="anchor" aria-label="anchor" href="#east"></a>
</h4>
<div class="figure">
<img src="figures/east_n_fix.png" alt="Sample size calculated by EAST" width="90%"><p class="caption">
Sample size calculated by EAST
</p>
</div>
</div>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>gsDesign2_info_scale_0 <span class="op">=</span> <span class="va">z_info_scale_0</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign2_info_scale_1 <span class="op">=</span> <span class="va">z_info_scale_1</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign2_info_scale_2 <span class="op">=</span> <span class="va">z_info_scale_2</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign <span class="op">=</span> <span class="va">x_gsDesign</span><span class="op">$</span><span class="va">n</span>, </span>
<span>               EAST_unpool <span class="op">=</span> <span class="fl">645</span>, </span>
<span>               EAST_pool <span class="op">=</span> <span class="fl">651</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"gsDesign2"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gsDesign2_info_scale_0</span>, <span class="va">gsDesign2_info_scale_1</span>, <span class="va">gsDesign2_info_scale_2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"EAST"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EAST_unpool</span>, <span class="va">EAST_pool</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>gsDesign2_info_scale_0 <span class="op">=</span> <span class="st">"info_scale = 0"</span>,</span>
<span>             gsDesign2_info_scale_1 <span class="op">=</span> <span class="st">"info_scale = 1"</span>,</span>
<span>             gsDesign2_info_scale_2 <span class="op">=</span> <span class="st">"info_scale = 2"</span>,</span>
<span>             EAST_unpool <span class="op">=</span> <span class="st">"un-pooled"</span>,</span>
<span>             EAST_pool <span class="op">=</span> <span class="st">"pooled"</span><span class="op">)</span></span></code></pre></div>
<div id="cwcykjkhzj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#cwcykjkhzj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cwcykjkhzj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cwcykjkhzj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cwcykjkhzj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cwcykjkhzj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcykjkhzj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cwcykjkhzj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cwcykjkhzj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cwcykjkhzj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cwcykjkhzj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cwcykjkhzj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cwcykjkhzj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#cwcykjkhzj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cwcykjkhzj .gt_from_md > :first-child {
  margin-top: 0;
}

#cwcykjkhzj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cwcykjkhzj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cwcykjkhzj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcykjkhzj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cwcykjkhzj .gt_row_group_first td {
  border-top-width: 2px;
}

#cwcykjkhzj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcykjkhzj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cwcykjkhzj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cwcykjkhzj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcykjkhzj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcykjkhzj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cwcykjkhzj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cwcykjkhzj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcykjkhzj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cwcykjkhzj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcykjkhzj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cwcykjkhzj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcykjkhzj .gt_left {
  text-align: left;
}

#cwcykjkhzj .gt_center {
  text-align: center;
}

#cwcykjkhzj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cwcykjkhzj .gt_font_normal {
  font-weight: normal;
}

#cwcykjkhzj .gt_font_bold {
  font-weight: bold;
}

#cwcykjkhzj .gt_font_italic {
  font-style: italic;
}

#cwcykjkhzj .gt_super {
  font-size: 65%;
}

#cwcykjkhzj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#cwcykjkhzj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cwcykjkhzj .gt_indent_1 {
  text-indent: 5px;
}

#cwcykjkhzj .gt_indent_2 {
  text-indent: 10px;
}

#cwcykjkhzj .gt_indent_3 {
  text-indent: 15px;
}

#cwcykjkhzj .gt_indent_4 {
  text-indent: 20px;
}

#cwcykjkhzj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup">
        <span class="gt_column_spanner">gsDesign2</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">gsDesign</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">EAST</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">un-pooled</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">pooled</th>
    </tr>
</thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right">654.9627</td>
<td class="gt_row gt_right">644.4553</td>
<td class="gt_row gt_right">650.7984</td>
<td class="gt_row gt_right">650.7984</td>
<td class="gt_row gt_right">645</td>
<td class="gt_row gt_right">651</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="unstratified-group-sequential-design">Unstratified Group Sequential Design<a class="anchor" aria-label="anchor" href="#unstratified-group-sequential-design"></a>
</h3>
<p>The example discussed in this section is an unstratified group sequential design with equal sized groups to detect <span class="math inline">\(p_C = 0.15, p_E = .1\)</span>.<br>
Under the null hypothesis, we assume <span class="math inline">\(p_C = p_E = 0.125\)</span>. We desire 90% power for a two-sided test for two proportions at <span class="math inline">\(\alpha = 0.05\)</span>. And we would like to calculate the sample size to achieve the 90% power.</p>
<div class="section level4">
<h4 id="gsdesign2-1">
<code>gsDesign2</code><a class="anchor" aria-label="anchor" href="#gsdesign2-1"></a>
</h4>
<p>To calculate the sample size, one can use <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code>. The logic of <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code> is to calculate the sample size of fixed design first.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_info_rd.html">gs_info_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, N <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>, Analysis <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_gs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The statistical information of the group sequential design"</span><span class="op">)</span></span></code></pre></div>
<div id="ivjsaplbzq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ivjsaplbzq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ivjsaplbzq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivjsaplbzq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ivjsaplbzq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ivjsaplbzq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjsaplbzq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivjsaplbzq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ivjsaplbzq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ivjsaplbzq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ivjsaplbzq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ivjsaplbzq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ivjsaplbzq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ivjsaplbzq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ivjsaplbzq .gt_from_md > :first-child {
  margin-top: 0;
}

#ivjsaplbzq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ivjsaplbzq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ivjsaplbzq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjsaplbzq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ivjsaplbzq .gt_row_group_first td {
  border-top-width: 2px;
}

#ivjsaplbzq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjsaplbzq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ivjsaplbzq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ivjsaplbzq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjsaplbzq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjsaplbzq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ivjsaplbzq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ivjsaplbzq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivjsaplbzq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivjsaplbzq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjsaplbzq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivjsaplbzq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivjsaplbzq .gt_left {
  text-align: left;
}

#ivjsaplbzq .gt_center {
  text-align: center;
}

#ivjsaplbzq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ivjsaplbzq .gt_font_normal {
  font-weight: normal;
}

#ivjsaplbzq .gt_font_bold {
  font-weight: bold;
}

#ivjsaplbzq .gt_font_italic {
  font-style: italic;
}

#ivjsaplbzq .gt_super {
  font-size: 65%;
}

#ivjsaplbzq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ivjsaplbzq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ivjsaplbzq .gt_indent_1 {
  text-indent: 5px;
}

#ivjsaplbzq .gt_indent_2 {
  text-indent: 10px;
}

#ivjsaplbzq .gt_indent_3 {
  text-indent: 15px;
}

#ivjsaplbzq .gt_indent_4 {
  text-indent: 20px;
}

#ivjsaplbzq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>The statistical information of the group sequential design</td>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">theta0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info0</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.3333333</td>
<td class="gt_row gt_right">0.05</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.04376881</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.7662835</td>
<td class="gt_row gt_right">0.7619048</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0.6666667</td>
<td class="gt_row gt_right">0.05</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.06189845</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1.5325670</td>
<td class="gt_row gt_right">1.5238095</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1.0000000</td>
<td class="gt_row gt_right">0.05</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.07580980</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">2.2988506</td>
<td class="gt_row gt_right">2.2857143</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># info_scale = 0</span></span>
<span><span class="va">y_gs0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.05</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, beta <span class="op">=</span> <span class="fl">.1</span>, binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># info_scale = 1</span></span>
<span><span class="va">y_gs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.05</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info1</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, beta <span class="op">=</span> <span class="fl">.1</span>, binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># info_scale = 2</span></span>
<span><span class="va">y_gs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fl">.05</span>, </span>
<span>  info <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, beta <span class="op">=</span> <span class="fl">.1</span>, binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>`info_scale = 0` <span class="op">=</span> <span class="va">y_gs0</span><span class="op">$</span><span class="va">info0</span> <span class="op">/</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info0</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>       `info_scale = 1` <span class="op">=</span> <span class="va">y_gs1</span><span class="op">$</span><span class="va">info1</span> <span class="op">/</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>       `info_scale = 2` <span class="op">=</span> <span class="va">y_gs2</span><span class="op">$</span><span class="va">info</span> <span class="op">/</span> <span class="va">x_gs</span><span class="op">$</span><span class="va">info1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The sample size calculated by `gsDesign2` under 3 info_scale"</span>, subtitle <span class="op">=</span> <span class="st">"under group sequential design"</span><span class="op">)</span></span></code></pre></div>
<div id="puewsuftyh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#puewsuftyh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#puewsuftyh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#puewsuftyh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#puewsuftyh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#puewsuftyh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#puewsuftyh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#puewsuftyh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#puewsuftyh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#puewsuftyh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#puewsuftyh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#puewsuftyh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#puewsuftyh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#puewsuftyh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#puewsuftyh .gt_from_md > :first-child {
  margin-top: 0;
}

#puewsuftyh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#puewsuftyh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#puewsuftyh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#puewsuftyh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#puewsuftyh .gt_row_group_first td {
  border-top-width: 2px;
}

#puewsuftyh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#puewsuftyh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#puewsuftyh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#puewsuftyh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#puewsuftyh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#puewsuftyh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#puewsuftyh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#puewsuftyh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#puewsuftyh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#puewsuftyh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#puewsuftyh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#puewsuftyh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#puewsuftyh .gt_left {
  text-align: left;
}

#puewsuftyh .gt_center {
  text-align: center;
}

#puewsuftyh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#puewsuftyh .gt_font_normal {
  font-weight: normal;
}

#puewsuftyh .gt_font_bold {
  font-weight: bold;
}

#puewsuftyh .gt_font_italic {
  font-style: italic;
}

#puewsuftyh .gt_super {
  font-size: 65%;
}

#puewsuftyh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#puewsuftyh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#puewsuftyh .gt_indent_1 {
  text-indent: 5px;
}

#puewsuftyh .gt_indent_2 {
  text-indent: 10px;
}

#puewsuftyh .gt_indent_3 {
  text-indent: 15px;
}

#puewsuftyh .gt_indent_4 {
  text-indent: 20px;
}

#puewsuftyh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<td colspan="3" class="gt_heading gt_title gt_font_normal" style>The sample size calculated by `gsDesign2` under 3 info_scale</td>
    </tr>
<tr>
<td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>under group sequential design</td>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">620.1976</td>
<td class="gt_row gt_right">616.6536</td>
<td class="gt_row gt_right">618.3786</td>
</tr>
<tr>
<td class="gt_row gt_right">620.1976</td>
<td class="gt_row gt_right">616.6536</td>
<td class="gt_row gt_right">618.3786</td>
</tr>
<tr>
<td class="gt_row gt_right">1240.3952</td>
<td class="gt_row gt_right">1233.3072</td>
<td class="gt_row gt_right">1236.7572</td>
</tr>
<tr>
<td class="gt_row gt_right">1240.3952</td>
<td class="gt_row gt_right">1233.3072</td>
<td class="gt_row gt_right">1236.7572</td>
</tr>
<tr>
<td class="gt_row gt_right">1860.5927</td>
<td class="gt_row gt_right">1849.9608</td>
<td class="gt_row gt_right">1855.1358</td>
</tr>
<tr>
<td class="gt_row gt_right">1860.5927</td>
<td class="gt_row gt_right">1849.9608</td>
<td class="gt_row gt_right">1855.1358</td>
</tr>
</tbody>
</table>
</div>
<p>The above logic is implemented in <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_gsDesign2_info_scale_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,                </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_gsDesign2_info_scale_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,                </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_gsDesign2_info_scale_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="st">"All"</span>, Rate <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,                </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"un-stratified"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gsdesign-1">
<code>gsDesign</code><a class="anchor" aria-label="anchor" href="#gsdesign-1"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/varBinomial.html" class="external-link">nBinomial</a></span><span class="op">(</span></span>
<span>  <span class="co"># Control event rate</span></span>
<span>  p1 <span class="op">=</span> <span class="fl">.15</span>, </span>
<span>  <span class="co"># Experimental event rate</span></span>
<span>  p2 <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>  <span class="co"># Null hypothesis event rate difference (control - experimental)</span></span>
<span>  delta0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  <span class="co"># 1-sided Type I error</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, </span>
<span>  <span class="co"># Type II error (1 - Power)</span></span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>  <span class="co"># Experimental/Control randomization ratio</span></span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The sample size of fixed-design calculated by `gsDesign` is "</span>, <span class="va">n_fix</span>, <span class="st">".\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The sample size of fixed-design calculated by `gsDesign` is  1834.641 .</span></span>
<span></span>
<span><span class="va">x_gsDesign</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="co"># 1-sided Type I error</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>, </span>
<span>  <span class="co"># Type II error (1 - Power)</span></span>
<span>  beta <span class="op">=</span> <span class="fl">.1</span>,    </span>
<span>  <span class="co"># If test.type = 5 or 6, this sets maximum spending for futility</span></span>
<span>  <span class="co"># under the null hypothesis. Otherwise, this is ignored.</span></span>
<span>  astar <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  timing <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfLDOF</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfLDOF</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="co"># Difference in event rates under alternate hypothesis</span></span>
<span>  delta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co"># Difference in rates under H1</span></span>
<span>  delta1 <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  <span class="co"># Difference in rates under H0</span></span>
<span>  delta0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  endpoint <span class="op">=</span> <span class="st">"Binomial"</span>,</span>
<span>  <span class="co"># Fixed design sample size from nBinomial above</span></span>
<span>  n.fix <span class="op">=</span> <span class="va">n_fix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The sample size calcuated by `gsDesign` is "</span>, <span class="va">x_gsDesign</span><span class="op">$</span><span class="va">n.I</span>, <span class="st">".\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The sample size calcuated by `gsDesign` is  618.7954 1237.591 1856.386 .</span></span>
<span></span>
<span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsBoundSummary.html" class="external-link">gsBoundSummary</a></span><span class="op">(</span><span class="va">x_gsDesign</span>, digits <span class="op">=</span> <span class="fl">4</span>, ddigits <span class="op">=</span> <span class="fl">2</span>, tdigits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Analysis                  Value Efficacy</span></span>
<span><span class="co">#&gt;  IA 1: 33%                      Z   3.7103</span></span>
<span><span class="co">#&gt;     N: 619            p (1-sided)   0.0001</span></span>
<span><span class="co">#&gt;                   ~delta at bound   0.0985</span></span>
<span><span class="co">#&gt;               P(Cross) if delta=0   0.0001</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=0.05   0.0338</span></span>
<span><span class="co">#&gt;  IA 2: 67%                      Z   2.5114</span></span>
<span><span class="co">#&gt;    N: 1238            p (1-sided)   0.0060</span></span>
<span><span class="co">#&gt;                   ~delta at bound   0.0472</span></span>
<span><span class="co">#&gt;               P(Cross) if delta=0   0.0060</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=0.05   0.5603</span></span>
<span><span class="co">#&gt;      Final                      Z   1.9930</span></span>
<span><span class="co">#&gt;    N: 1857            p (1-sided)   0.0231</span></span>
<span><span class="co">#&gt;                   ~delta at bound   0.0306</span></span>
<span><span class="co">#&gt;               P(Cross) if delta=0   0.0250</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=0.05   0.9000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="east-1">EAST<a class="anchor" aria-label="anchor" href="#east-1"></a>
</h4>
<div class="figure">
<img src="figures/east_n_gs.png" alt="Sample size calculated by EAST" width="90%"><p class="caption">
Sample size calculated by EAST
</p>
</div>
<div class="figure">
<img src="figures/east_n_gs_unpool.png" alt="Sample size calculated by EAST" width="90%"><p class="caption">
Sample size calculated by EAST
</p>
</div>
<div class="figure">
<img src="figures/east_n_gs_pool.png" alt="Sample size calculated by EAST" width="90%"><p class="caption">
Sample size calculated by EAST
</p>
</div>
</div>
<div class="section level4">
<h4 id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>gsDesign2_info_scale_0 <span class="op">=</span> <span class="va">x_gsDesign2_info_scale_0</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign2_info_scale_1 <span class="op">=</span> <span class="va">x_gsDesign2_info_scale_1</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign2_info_scale_2 <span class="op">=</span> <span class="va">x_gsDesign2_info_scale_2</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span>,</span>
<span>               gsDesign <span class="op">=</span> <span class="va">x_gsDesign</span><span class="op">$</span><span class="va">n.I</span>,</span>
<span>               EAST_unpool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">617</span>, <span class="fl">1233</span>, <span class="fl">1850</span><span class="op">)</span>,</span>
<span>               EAST_pool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">619</span>, <span class="fl">1238</span>, <span class="fl">1857</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"gsDesign2"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gsDesign2_info_scale_0</span>, <span class="va">gsDesign2_info_scale_1</span>, <span class="va">gsDesign2_info_scale_2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"EAST"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EAST_unpool</span>, <span class="va">EAST_pool</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>gsDesign2_info_scale_0 <span class="op">=</span> <span class="st">"info_scale = 0"</span>,</span>
<span>             gsDesign2_info_scale_1 <span class="op">=</span> <span class="st">"info_scale = 1"</span>,</span>
<span>             gsDesign2_info_scale_2 <span class="op">=</span> <span class="st">"info_scale = 2"</span>,</span>
<span>             EAST_unpool <span class="op">=</span> <span class="st">"un-pooled"</span>,</span>
<span>             EAST_pool <span class="op">=</span> <span class="st">"pooled"</span><span class="op">)</span></span></code></pre></div>
<div id="hqtxylzkvq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hqtxylzkvq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hqtxylzkvq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hqtxylzkvq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hqtxylzkvq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hqtxylzkvq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqtxylzkvq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hqtxylzkvq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hqtxylzkvq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hqtxylzkvq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hqtxylzkvq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hqtxylzkvq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hqtxylzkvq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hqtxylzkvq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hqtxylzkvq .gt_from_md > :first-child {
  margin-top: 0;
}

#hqtxylzkvq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hqtxylzkvq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hqtxylzkvq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hqtxylzkvq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hqtxylzkvq .gt_row_group_first td {
  border-top-width: 2px;
}

#hqtxylzkvq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqtxylzkvq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hqtxylzkvq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hqtxylzkvq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqtxylzkvq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqtxylzkvq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hqtxylzkvq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hqtxylzkvq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqtxylzkvq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hqtxylzkvq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqtxylzkvq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hqtxylzkvq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqtxylzkvq .gt_left {
  text-align: left;
}

#hqtxylzkvq .gt_center {
  text-align: center;
}

#hqtxylzkvq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hqtxylzkvq .gt_font_normal {
  font-weight: normal;
}

#hqtxylzkvq .gt_font_bold {
  font-weight: bold;
}

#hqtxylzkvq .gt_font_italic {
  font-style: italic;
}

#hqtxylzkvq .gt_super {
  font-size: 65%;
}

#hqtxylzkvq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hqtxylzkvq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hqtxylzkvq .gt_indent_1 {
  text-indent: 5px;
}

#hqtxylzkvq .gt_indent_2 {
  text-indent: 10px;
}

#hqtxylzkvq .gt_indent_3 {
  text-indent: 15px;
}

#hqtxylzkvq .gt_indent_4 {
  text-indent: 20px;
}

#hqtxylzkvq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup">
        <span class="gt_column_spanner">gsDesign2</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col">gsDesign</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup">
        <span class="gt_column_spanner">EAST</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">un-pooled</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">pooled</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">620.1976</td>
<td class="gt_row gt_right">616.6536</td>
<td class="gt_row gt_right">618.3786</td>
<td class="gt_row gt_right">618.7954</td>
<td class="gt_row gt_right">617</td>
<td class="gt_row gt_right">619</td>
</tr>
<tr>
<td class="gt_row gt_right">1240.3952</td>
<td class="gt_row gt_right">1233.3072</td>
<td class="gt_row gt_right">1236.7572</td>
<td class="gt_row gt_right">1237.5909</td>
<td class="gt_row gt_right">1233</td>
<td class="gt_row gt_right">1238</td>
</tr>
<tr>
<td class="gt_row gt_right">1860.5927</td>
<td class="gt_row gt_right">1849.9608</td>
<td class="gt_row gt_right">1855.1358</td>
<td class="gt_row gt_right">1856.3863</td>
<td class="gt_row gt_right">1850</td>
<td class="gt_row gt_right">1857</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="stratified-group-sequential-design">Stratified Group Sequential Design<a class="anchor" aria-label="anchor" href="#stratified-group-sequential-design"></a>
</h3>
<p>In this example, we consider 3 strata in a group sequential design with 3 analyses.</p>
<div class="section level4">
<h4 id="gsdesign2-2">
<code>gsDesign2</code><a class="anchor" aria-label="anchor" href="#gsdesign2-2"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">prevalence_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> </span>
<span><span class="va">p_c_by_stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.37</span>, <span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">p_e_by_stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.3</span>, <span class="fl">.5</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">p_c</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, Rate <span class="op">=</span> <span class="va">p_c_by_stratum</span><span class="op">)</span></span>
<span><span class="va">p_e</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, Rate <span class="op">=</span> <span class="va">p_e_by_stratum</span><span class="op">)</span></span>
<span><span class="va">ratio_strata_c</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, ratio <span class="op">=</span> <span class="va">prevalence_ratio</span><span class="op">)</span></span>
<span><span class="va">ratio_strata_e</span> <span class="op">&lt;-</span> <span class="va">ratio_strata_c</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">IF</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span></span>
<span><span class="va">N_c</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ratio</span><span class="op">)</span> </span>
<span><span class="va">N_e</span> <span class="op">&lt;-</span> <span class="va">ratio</span> <span class="op">*</span> <span class="va">N_c</span> </span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">p_c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>p_c <span class="op">=</span> <span class="va">Rate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">p_e</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>p_e <span class="op">=</span> <span class="va">Rate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p_pool <span class="op">=</span> <span class="op">(</span><span class="va">p_c</span> <span class="op">+</span> <span class="va">p_e</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xi_c <span class="op">=</span> <span class="op">(</span><span class="va">ratio_strata_c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">ratio</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">prop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xi_e <span class="op">=</span> <span class="op">(</span><span class="va">ratio_strata_e</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">ratio</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">prop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>N_c <span class="op">=</span> <span class="va">N_c</span> <span class="op">*</span> <span class="va">xi_c</span>, N_e <span class="op">=</span> <span class="va">N_e</span> <span class="op">*</span> <span class="va">xi_e</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">8</span>, decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"p_pool = (p_c * N_c + p_e * N_e) / (N_c * N_e)."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">p_pool</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"xi_c = sample size of a strata / sample size of the control arm."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">xi_c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"xi_e = sample size of a strata / sample size of the experimental arm."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">xi_e</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"N_c = total sample size of the control arm."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">N_c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"N_e = total size of the experimental arm."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Stratified Example"</span><span class="op">)</span></span></code></pre></div>
<div id="vutnwdashq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vutnwdashq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vutnwdashq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vutnwdashq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vutnwdashq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vutnwdashq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vutnwdashq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vutnwdashq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vutnwdashq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vutnwdashq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vutnwdashq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vutnwdashq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vutnwdashq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vutnwdashq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vutnwdashq .gt_from_md > :first-child {
  margin-top: 0;
}

#vutnwdashq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vutnwdashq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vutnwdashq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vutnwdashq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vutnwdashq .gt_row_group_first td {
  border-top-width: 2px;
}

#vutnwdashq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vutnwdashq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vutnwdashq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vutnwdashq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vutnwdashq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vutnwdashq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vutnwdashq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vutnwdashq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vutnwdashq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vutnwdashq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vutnwdashq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vutnwdashq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vutnwdashq .gt_left {
  text-align: left;
}

#vutnwdashq .gt_center {
  text-align: center;
}

#vutnwdashq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vutnwdashq .gt_font_normal {
  font-weight: normal;
}

#vutnwdashq .gt_font_bold {
  font-weight: bold;
}

#vutnwdashq .gt_font_italic {
  font-style: italic;
}

#vutnwdashq .gt_super {
  font-size: 65%;
}

#vutnwdashq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vutnwdashq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vutnwdashq .gt_indent_1 {
  text-indent: 5px;
}

#vutnwdashq .gt_indent_2 {
  text-indent: 10px;
}

#vutnwdashq .gt_indent_3 {
  text-indent: 15px;
}

#vutnwdashq .gt_indent_4 {
  text-indent: 20px;
}

#vutnwdashq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Stratified Example</td>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_pool<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_c<sup class="gt_footnote_marks">2</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_e<sup class="gt_footnote_marks">3</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_c<sup class="gt_footnote_marks">4</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_e<sup class="gt_footnote_marks">5</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.2750</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.1333</td>
</tr>
<tr>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.3350</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.1667</td>
<td class="gt_row gt_right">0.1667</td>
</tr>
<tr>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.5500</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.2000</td>
<td class="gt_row gt_right">0.2000</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="8">
<sup class="gt_footnote_marks">1</sup> p_pool = (p_c * N_c + p_e * N_e) / (N_c * N_e).</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="8">
<sup class="gt_footnote_marks">2</sup> xi_c = sample size of a strata / sample size of the control arm.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="8">
<sup class="gt_footnote_marks">3</sup> xi_e = sample size of a strata / sample size of the experimental arm.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="8">
<sup class="gt_footnote_marks">4</sup> N_c = total sample size of the control arm.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="8">
<sup class="gt_footnote_marks">5</sup> N_e = total size of the experimental arm.</td>
    </tr>
</tfoot>
</table>
</div>
<p>First, we calculate the variance <span class="math display">\[
  \left\{
  \begin{array}{ll}
  \sigma^2_{H_0,k,s} 
  &amp; =
  p_{k,s}^{pool} \left(1 - p^{pool}_{k,s} \right) 
  \left(\frac{1}{N_{C,k,s}} + \frac{1}{N_{E,k,s}} \right) 
  =
  p_{k,s}^{pool} \left(1 - p^{pool}_{k,s} \right) 
  \left(\frac{1}{ \frac{\xi_s}{1+r} N_{k}} + \frac{1}{ \frac{r \xi_s}{1+r} N_{k}} \right) \\
  \sigma_{H_1,k,s}^2 
  &amp; = 
  \frac{p_{C,s} (1- p_{C,s})}{N_{C,k,s}} + \frac{p_{E,s} (1 - p_{E,s})}{N_{E,k,s}} 
  = 
  \frac{p_{C,s} (1- p_{C,s})}{\frac{\xi_s}{1+r} N_{k}} + \frac{p_{E,s} (1 - p_{E,s})}{\frac{r \xi_s}{1+r} N_{k}} 
  \end{array}
  \right.
\]</span></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html" class="external-link">union_all</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html" class="external-link">union_all</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Analysis <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, IF <span class="op">=</span> <span class="va">IF</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>N_c <span class="op">=</span> <span class="va">N_c</span> <span class="op">*</span> <span class="va">IF</span>, N_e <span class="op">=</span> <span class="va">N_e</span> <span class="op">*</span> <span class="va">IF</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Analysis</span>, <span class="va">Stratum</span>, <span class="va">p_c</span>, <span class="va">p_pool</span>, <span class="va">p_e</span>, <span class="va">N_c</span>, <span class="va">N_e</span>, <span class="va">xi_c</span>, <span class="va">xi_e</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sigma_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_pool</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">N_c</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         sigma_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_c</span><span class="op">)</span> <span class="op">/</span> <span class="va">N_c</span> <span class="op">+</span> <span class="va">p_e</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span> <span class="op">/</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">11</span>, decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"sigma_H0 = the H0 sd per stratum per analysis."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">sigma_H0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"sigma_H1 = the H0 sd per stratum per analysis."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">sigma_H1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="nmaeixbvjj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#nmaeixbvjj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nmaeixbvjj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nmaeixbvjj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nmaeixbvjj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nmaeixbvjj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nmaeixbvjj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nmaeixbvjj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nmaeixbvjj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nmaeixbvjj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nmaeixbvjj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nmaeixbvjj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nmaeixbvjj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#nmaeixbvjj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nmaeixbvjj .gt_from_md > :first-child {
  margin-top: 0;
}

#nmaeixbvjj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nmaeixbvjj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nmaeixbvjj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nmaeixbvjj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nmaeixbvjj .gt_row_group_first td {
  border-top-width: 2px;
}

#nmaeixbvjj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nmaeixbvjj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nmaeixbvjj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nmaeixbvjj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nmaeixbvjj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nmaeixbvjj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nmaeixbvjj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nmaeixbvjj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nmaeixbvjj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nmaeixbvjj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nmaeixbvjj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nmaeixbvjj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nmaeixbvjj .gt_left {
  text-align: left;
}

#nmaeixbvjj .gt_center {
  text-align: center;
}

#nmaeixbvjj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nmaeixbvjj .gt_font_normal {
  font-weight: normal;
}

#nmaeixbvjj .gt_font_bold {
  font-weight: bold;
}

#nmaeixbvjj .gt_font_italic {
  font-style: italic;
}

#nmaeixbvjj .gt_super {
  font-size: 65%;
}

#nmaeixbvjj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#nmaeixbvjj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nmaeixbvjj .gt_indent_1 {
  text-indent: 5px;
}

#nmaeixbvjj .gt_indent_2 {
  text-indent: 10px;
}

#nmaeixbvjj .gt_indent_3 {
  text-indent: 15px;
}

#nmaeixbvjj .gt_indent_4 {
  text-indent: 20px;
}

#nmaeixbvjj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_pool</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">sigma_H0<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">sigma_H1<sup class="gt_footnote_marks">2</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.0444</td>
<td class="gt_row gt_right">0.0444</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">2.9953</td>
<td class="gt_row gt_right">2.9906</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.0556</td>
<td class="gt_row gt_right">0.0556</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">2.8319</td>
<td class="gt_row gt_right">2.8241</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.0667</td>
<td class="gt_row gt_right">0.0667</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">2.7249</td>
<td class="gt_row gt_right">2.7111</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.0889</td>
<td class="gt_row gt_right">0.0889</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">2.1180</td>
<td class="gt_row gt_right">2.1147</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.1111</td>
<td class="gt_row gt_right">0.1111</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">2.0025</td>
<td class="gt_row gt_right">1.9970</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">1.9268</td>
<td class="gt_row gt_right">1.9170</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">1.7293</td>
<td class="gt_row gt_right">1.7266</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.1667</td>
<td class="gt_row gt_right">0.1667</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">1.6350</td>
<td class="gt_row gt_right">1.6305</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.2000</td>
<td class="gt_row gt_right">0.2000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">1.5732</td>
<td class="gt_row gt_right">1.5652</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">1</sup> sigma_H0 = the H0 sd per stratum per analysis.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">2</sup> sigma_H1 = the H0 sd per stratum per analysis.</td>
    </tr>
</tfoot>
</table>
</div>
<p>Second, we calculate the weight by using inverse variance</p>
<p><span class="math display">\[
  w_{s,k} = \frac{1/\sigma^2_{s,k}}{\sum_{s=1}^S 1/\sigma^2_{s,k}}. 
\]</span></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sum_invar_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">sigma_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>            sum_invar_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">sigma_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>            sum_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">N_c</span> <span class="op">*</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weight_invar_H0 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sigma_H0</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sum_invar_H0</span>,</span>
<span>         weight_invar_H1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sigma_H1</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sum_invar_H1</span>,</span>
<span>         weight_ss <span class="op">=</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">*</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="va">sum_ss</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sum_invar_H0</span>, <span class="va">sum_invar_H1</span>, <span class="va">sum_ss</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">14</span>, decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"weight_invar_H0 = the weight per stratum per analysis calculated by INVAR by using variance under H0."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">weight_invar_H0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"weight_invar_H1 = the weight per stratum per analysis calculated by INVAR by using variance under H1."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">weight_invar_H1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"weight_ss = the weight per stratum per analysis calculated by SS."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">weight_ss</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="dwylblxgti" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dwylblxgti .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dwylblxgti .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dwylblxgti .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dwylblxgti .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dwylblxgti .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dwylblxgti .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dwylblxgti .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dwylblxgti .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dwylblxgti .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dwylblxgti .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dwylblxgti .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dwylblxgti .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dwylblxgti .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dwylblxgti .gt_from_md > :first-child {
  margin-top: 0;
}

#dwylblxgti .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dwylblxgti .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dwylblxgti .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dwylblxgti .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dwylblxgti .gt_row_group_first td {
  border-top-width: 2px;
}

#dwylblxgti .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dwylblxgti .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dwylblxgti .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dwylblxgti .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dwylblxgti .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dwylblxgti .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dwylblxgti .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dwylblxgti .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dwylblxgti .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dwylblxgti .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dwylblxgti .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dwylblxgti .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dwylblxgti .gt_left {
  text-align: left;
}

#dwylblxgti .gt_center {
  text-align: center;
}

#dwylblxgti .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dwylblxgti .gt_font_normal {
  font-weight: normal;
}

#dwylblxgti .gt_font_bold {
  font-weight: bold;
}

#dwylblxgti .gt_font_italic {
  font-style: italic;
}

#dwylblxgti .gt_super {
  font-size: 65%;
}

#dwylblxgti .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dwylblxgti .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dwylblxgti .gt_indent_1 {
  text-indent: 5px;
}

#dwylblxgti .gt_indent_2 {
  text-indent: 10px;
}

#dwylblxgti .gt_indent_3 {
  text-indent: 15px;
}

#dwylblxgti .gt_indent_4 {
  text-indent: 20px;
}

#dwylblxgti .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_pool</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">p_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">N_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_c</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">xi_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">sigma_H0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">sigma_H1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">weight_invar_H0<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">weight_invar_H1<sup class="gt_footnote_marks">2</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">weight_ss<sup class="gt_footnote_marks">3</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.0444</td>
<td class="gt_row gt_right">0.0444</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">2.9953</td>
<td class="gt_row gt_right">2.9906</td>
<td class="gt_row gt_right">0.3006</td>
<td class="gt_row gt_right">0.2996</td>
<td class="gt_row gt_right">0.2667</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.0556</td>
<td class="gt_row gt_right">0.0556</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">2.8319</td>
<td class="gt_row gt_right">2.8241</td>
<td class="gt_row gt_right">0.3362</td>
<td class="gt_row gt_right">0.3359</td>
<td class="gt_row gt_right">0.3333</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.0667</td>
<td class="gt_row gt_right">0.0667</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">2.7249</td>
<td class="gt_row gt_right">2.7111</td>
<td class="gt_row gt_right">0.3632</td>
<td class="gt_row gt_right">0.3645</td>
<td class="gt_row gt_right">0.4000</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.0889</td>
<td class="gt_row gt_right">0.0889</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">2.1180</td>
<td class="gt_row gt_right">2.1147</td>
<td class="gt_row gt_right">0.3006</td>
<td class="gt_row gt_right">0.2996</td>
<td class="gt_row gt_right">0.2667</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.1111</td>
<td class="gt_row gt_right">0.1111</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">2.0025</td>
<td class="gt_row gt_right">1.9970</td>
<td class="gt_row gt_right">0.3362</td>
<td class="gt_row gt_right">0.3359</td>
<td class="gt_row gt_right">0.3333</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">1.9268</td>
<td class="gt_row gt_right">1.9170</td>
<td class="gt_row gt_right">0.3632</td>
<td class="gt_row gt_right">0.3645</td>
<td class="gt_row gt_right">0.4000</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S1</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.275</td>
<td class="gt_row gt_right">0.25</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.1333</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">0.2667</td>
<td class="gt_row gt_right">1.7293</td>
<td class="gt_row gt_right">1.7266</td>
<td class="gt_row gt_right">0.3006</td>
<td class="gt_row gt_right">0.2996</td>
<td class="gt_row gt_right">0.2667</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S2</td>
<td class="gt_row gt_right">0.37</td>
<td class="gt_row gt_right">0.335</td>
<td class="gt_row gt_right">0.30</td>
<td class="gt_row gt_right">0.1667</td>
<td class="gt_row gt_right">0.1667</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">0.3333</td>
<td class="gt_row gt_right">1.6350</td>
<td class="gt_row gt_right">1.6305</td>
<td class="gt_row gt_right">0.3362</td>
<td class="gt_row gt_right">0.3359</td>
<td class="gt_row gt_right">0.3333</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">S3</td>
<td class="gt_row gt_right">0.60</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">0.50</td>
<td class="gt_row gt_right">0.2000</td>
<td class="gt_row gt_right">0.2000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">0.4000</td>
<td class="gt_row gt_right">1.5732</td>
<td class="gt_row gt_right">1.5652</td>
<td class="gt_row gt_right">0.3632</td>
<td class="gt_row gt_right">0.3645</td>
<td class="gt_row gt_right">0.4000</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="14">
<sup class="gt_footnote_marks">1</sup> weight_invar_H0 = the weight per stratum per analysis calculated by INVAR by using variance under H0.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="14">
<sup class="gt_footnote_marks">2</sup> weight_invar_H1 = the weight per stratum per analysis calculated by INVAR by using variance under H1.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="14">
<sup class="gt_footnote_marks">3</sup> weight_ss = the weight per stratum per analysis calculated by SS.</td>
    </tr>
</tfoot>
</table>
</div>
<p>Third, we calculate the weighted risk difference and weighted statistical information. <span class="math display">\[
  \left\{
  \begin{array}{ll}
    \delta_{H_0,k} 
    &amp; = 0\\
    \delta_{H_1,k} 
    &amp; = \sum_{s=1}^S w_{k,s} |p_{C,s} - p_{E,s}|
  \end{array}
  \right. \\
  \left\{
  \begin{array}{ll}
    \mathcal I_{H_0,k} 
    &amp; = 
    \left[ 
      \sum_{s=1}^S 
      w_{k,s}^2 \frac{p_{k,s}^{pool} (1 - p_{k,s}^{pool})}{N_{C, k, s}} + 
      w_{k,s}^2 \frac{p_{k,s}^{pool} (1 - p_{k,s}^{pool})}{N_{E, k, s}} 
    \right]^{-1}\\
    \mathcal I_{H_1,k}  
    &amp; = 
    \left[ 
      \sum_{s=1}^S w_{k,s}^2 \frac{p_{C,k,s} (1 - p_{C,k,s})}{N_{C,k,s}}
      +
      \sum_{s=1}^S w_{k,s}^2 \frac{p_{E,k,s} (1 - p_{E,k,s})}{N_{E,k,s}} 
    \right]^{-1}
  \end{array}
  \right. \\
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Analysis</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>rd_invar_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            rd_invar_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            rd_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            rd0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>            info_invar_H0 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>            info_invar_H1 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>            info_ss <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>            info0_invar_H0 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>            info0_invar_H1 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>            info0_ss <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span></span>
<span>            <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info_invar_H0 = the statistical information under H1 per stratum per analysis calculated by INVAR by using variance under H0."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info_invar_H0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info_invar_H1 = the statistical information under H1 per stratum per analysis calculated by INVAR by using variance under H0."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info_invar_H1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info_ss = the statistical information under H1 per stratum per analysis calculated by SS."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info_ss</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info0_invar_H0 = the statistical information under H0 per stratum per analysis calculated by INVAR by using variance under H0."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info0_invar_H0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info0_invar_H1 = the statistical information under H0 per stratum per analysis calculated by INVAR by using variance under H0."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info0_invar_H1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_footnote.html" class="external-link">tab_footnote</a></span><span class="op">(</span>footnote <span class="op">=</span> <span class="st">"info0_ss = the statistical information under H0 per stratum per analysis calculated by SS."</span>,</span>
<span>                   locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cells_column_labels.html" class="external-link">cells_column_labels</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">info0_ss</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="vcjpyyshrx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vcjpyyshrx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vcjpyyshrx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vcjpyyshrx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vcjpyyshrx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vcjpyyshrx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vcjpyyshrx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vcjpyyshrx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vcjpyyshrx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vcjpyyshrx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vcjpyyshrx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vcjpyyshrx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vcjpyyshrx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vcjpyyshrx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vcjpyyshrx .gt_from_md > :first-child {
  margin-top: 0;
}

#vcjpyyshrx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vcjpyyshrx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vcjpyyshrx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vcjpyyshrx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vcjpyyshrx .gt_row_group_first td {
  border-top-width: 2px;
}

#vcjpyyshrx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vcjpyyshrx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vcjpyyshrx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vcjpyyshrx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vcjpyyshrx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vcjpyyshrx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vcjpyyshrx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vcjpyyshrx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vcjpyyshrx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vcjpyyshrx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vcjpyyshrx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vcjpyyshrx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vcjpyyshrx .gt_left {
  text-align: left;
}

#vcjpyyshrx .gt_center {
  text-align: center;
}

#vcjpyyshrx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vcjpyyshrx .gt_font_normal {
  font-weight: normal;
}

#vcjpyyshrx .gt_font_bold {
  font-weight: bold;
}

#vcjpyyshrx .gt_font_italic {
  font-style: italic;
}

#vcjpyyshrx .gt_super {
  font-size: 65%;
}

#vcjpyyshrx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vcjpyyshrx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vcjpyyshrx .gt_indent_1 {
  text-indent: 5px;
}

#vcjpyyshrx .gt_indent_2 {
  text-indent: 10px;
}

#vcjpyyshrx .gt_indent_3 {
  text-indent: 15px;
}

#vcjpyyshrx .gt_indent_4 {
  text-indent: 20px;
}

#vcjpyyshrx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd_invar_H0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd_invar_H1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd_ss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">rd0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_invar_H0<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_invar_H1<sup class="gt_footnote_marks">2</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_ss<sup class="gt_footnote_marks">3</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info0_invar_H0<sup class="gt_footnote_marks">4</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info0_invar_H1<sup class="gt_footnote_marks">5</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info0_ss<sup class="gt_footnote_marks">6</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.074884</td>
<td class="gt_row gt_right">0.074944</td>
<td class="gt_row gt_right">0.076667</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.373240</td>
<td class="gt_row gt_right">0.373244</td>
<td class="gt_row gt_right">0.370617</td>
<td class="gt_row gt_right">0.370829</td>
<td class="gt_row gt_right">0.370826</td>
<td class="gt_row gt_right">0.368039</td>
</tr>
<tr>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0.074884</td>
<td class="gt_row gt_right">0.074944</td>
<td class="gt_row gt_right">0.076667</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0.746481</td>
<td class="gt_row gt_right">0.746487</td>
<td class="gt_row gt_right">0.741235</td>
<td class="gt_row gt_right">0.741659</td>
<td class="gt_row gt_right">0.741652</td>
<td class="gt_row gt_right">0.736079</td>
</tr>
<tr>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0.074884</td>
<td class="gt_row gt_right">0.074944</td>
<td class="gt_row gt_right">0.076667</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">1.119721</td>
<td class="gt_row gt_right">1.119731</td>
<td class="gt_row gt_right">1.111852</td>
<td class="gt_row gt_right">1.112488</td>
<td class="gt_row gt_right">1.112479</td>
<td class="gt_row gt_right">1.104118</td>
</tr>
</tbody>
<tfoot class="gt_footnotes">
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">1</sup> info_invar_H0 = the statistical information under H1 per stratum per analysis calculated by INVAR by using variance under H0.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">2</sup> info_invar_H1 = the statistical information under H1 per stratum per analysis calculated by INVAR by using variance under H0.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">3</sup> info_ss = the statistical information under H1 per stratum per analysis calculated by SS.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">4</sup> info0_invar_H0 = the statistical information under H0 per stratum per analysis calculated by INVAR by using variance under H0.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">5</sup> info0_invar_H1 = the statistical information under H0 per stratum per analysis calculated by INVAR by using variance under H0.</td>
    </tr>
<tr>
<td class="gt_footnote" colspan="11">
<sup class="gt_footnote_marks">6</sup> info0_ss = the statistical information under H0 per stratum per analysis calculated by SS.</td>
    </tr>
</tfoot>
</table>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ----------------------------------- # </span></span>
<span><span class="co">#     sample size under H0            #</span></span>
<span><span class="co"># ----------------------------------- # </span></span>
<span><span class="va">y_invar_H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H0</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_invar_H1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_ss</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----------------------------------- # </span></span>
<span><span class="co">#     sample size under H1            #</span></span>
<span><span class="co"># ----------------------------------- # </span></span>
<span><span class="va">yy_invar_H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H0</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H0</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">yy_invar_H1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">yy_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_npe.html">gs_design_npe</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_ss</span>,</span>
<span>  info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_ss</span>, </span>
<span>  info0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span>, </span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">0.2</span>,                </span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ans_math</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>`Weighting method` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"INVAR-H0"</span>, <span class="st">"INVAR-H1"</span>, <span class="st">"Sample Size"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           `Calculated under` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"H0"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           `Sample size` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_invar_H0</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                                             <span class="va">y_invar_H1</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                                             <span class="va">y_ss</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                                             <span class="va">yy_invar_H0</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H0</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                                             <span class="va">yy_invar_H1</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                                             <span class="va">yy_ss</span><span class="op">$</span><span class="va">info</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_ss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">ans_math</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample size calculated by INVAR and SS"</span><span class="op">)</span></span></code></pre></div>
<div id="yzurqwfwhk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#yzurqwfwhk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzurqwfwhk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzurqwfwhk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzurqwfwhk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzurqwfwhk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzurqwfwhk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzurqwfwhk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzurqwfwhk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzurqwfwhk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzurqwfwhk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzurqwfwhk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzurqwfwhk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#yzurqwfwhk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzurqwfwhk .gt_from_md > :first-child {
  margin-top: 0;
}

#yzurqwfwhk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzurqwfwhk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzurqwfwhk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzurqwfwhk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzurqwfwhk .gt_row_group_first td {
  border-top-width: 2px;
}

#yzurqwfwhk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzurqwfwhk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzurqwfwhk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzurqwfwhk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzurqwfwhk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzurqwfwhk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzurqwfwhk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzurqwfwhk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzurqwfwhk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzurqwfwhk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzurqwfwhk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzurqwfwhk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzurqwfwhk .gt_left {
  text-align: left;
}

#yzurqwfwhk .gt_center {
  text-align: center;
}

#yzurqwfwhk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzurqwfwhk .gt_font_normal {
  font-weight: normal;
}

#yzurqwfwhk .gt_font_bold {
  font-weight: bold;
}

#yzurqwfwhk .gt_font_italic {
  font-style: italic;
}

#yzurqwfwhk .gt_super {
  font-size: 65%;
}

#yzurqwfwhk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#yzurqwfwhk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzurqwfwhk .gt_indent_1 {
  text-indent: 5px;
}

#yzurqwfwhk .gt_indent_2 {
  text-indent: 10px;
}

#yzurqwfwhk .gt_indent_3 {
  text-indent: 15px;
}

#yzurqwfwhk .gt_indent_4 {
  text-indent: 20px;
}

#yzurqwfwhk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Sample size calculated by INVAR and SS</td>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Weighting method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Calculated under</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">Sample size</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">INVAR-H0</td>
<td class="gt_row gt_left">H0</td>
<td class="gt_row gt_right">849.4965</td>
</tr>
<tr>
<td class="gt_row gt_left">INVAR-H1</td>
<td class="gt_row gt_left">H0</td>
<td class="gt_row gt_right">848.1421</td>
</tr>
<tr>
<td class="gt_row gt_left">Sample Size</td>
<td class="gt_row gt_left">H0</td>
<td class="gt_row gt_right">816.5992</td>
</tr>
<tr>
<td class="gt_row gt_left">INVAR-H0</td>
<td class="gt_row gt_left">H1</td>
<td class="gt_row gt_right">845.1771</td>
</tr>
<tr>
<td class="gt_row gt_left">INVAR-H1</td>
<td class="gt_row gt_left">H1</td>
<td class="gt_row gt_right">843.8182</td>
</tr>
<tr>
<td class="gt_row gt_left">Sample Size</td>
<td class="gt_row gt_left">H1</td>
<td class="gt_row gt_right">812.1270</td>
</tr>
</tbody>
</table>
</div>
<p>The above logic is implemented in <code><a href="../reference/gs_design_rd.html">gs_design_rd()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## sample size weighting + information scale = 0</span></span>
<span><span class="va">x_ss0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"ss"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## sample size weighting + information scale = 1</span></span>
<span><span class="va">x_ss1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"ss"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## sample size weighting + information scale = 2</span></span>
<span><span class="va">x_ss2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"ss"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inverse variance weighting + information scale = 0</span></span>
<span><span class="va">x_invar0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"invar"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inverse variance weighting + information scale = 1</span></span>
<span><span class="va">x_invar1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"invar"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inverse variance weighting + information scale = 2</span></span>
<span><span class="va">x_invar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_design_rd.html">gs_design_rd</a></span><span class="op">(</span></span>
<span>  p_c <span class="op">=</span> <span class="va">p_c</span>,</span>
<span>  p_e <span class="op">=</span> <span class="va">p_e</span>,</span>
<span>  IF <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  rd0 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,                  </span>
<span>  beta <span class="op">=</span> <span class="fl">.2</span>,                    </span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stratum_prev <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, prevalence <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="st">"invar"</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_b</span>,</span>
<span>  upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  binding <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>INVAR0 <span class="op">=</span> <span class="va">x_invar0</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>               INVAR1 <span class="op">=</span> <span class="va">x_invar1</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>               INVAR2 <span class="op">=</span> <span class="va">x_invar2</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>               SS0 <span class="op">=</span> <span class="va">x_ss0</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>               SS1 <span class="op">=</span> <span class="va">x_ss1</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>               SS2 <span class="op">=</span> <span class="va">x_ss2</span><span class="op">$</span><span class="va">analysis</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="va">ans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample size calculated by INVAR and SS"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Inverse variance weighting"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">INVAR0</span>, <span class="va">INVAR1</span>, <span class="va">INVAR2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Sample size wighting"</span>,</span>
<span>                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SS0</span>, <span class="va">SS1</span>, <span class="va">SS2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>INVAR0 <span class="op">=</span> <span class="st">"info_scale = 0"</span>,</span>
<span>             INVAR1 <span class="op">=</span> <span class="st">"info_scale = 1"</span>,</span>
<span>             INVAR2 <span class="op">=</span> <span class="st">"info_scale = 2"</span>,</span>
<span>             SS0 <span class="op">=</span> <span class="st">"info_scale = 0"</span>,</span>
<span>             SS1 <span class="op">=</span> <span class="st">"info_scale = 1"</span>,</span>
<span>             SS2 <span class="op">=</span> <span class="st">"info_scale = 2"</span><span class="op">)</span></span></code></pre></div>
<div id="jarsrnopkf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jarsrnopkf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jarsrnopkf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jarsrnopkf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jarsrnopkf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jarsrnopkf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jarsrnopkf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jarsrnopkf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jarsrnopkf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jarsrnopkf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jarsrnopkf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jarsrnopkf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jarsrnopkf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jarsrnopkf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jarsrnopkf .gt_from_md > :first-child {
  margin-top: 0;
}

#jarsrnopkf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jarsrnopkf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jarsrnopkf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jarsrnopkf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jarsrnopkf .gt_row_group_first td {
  border-top-width: 2px;
}

#jarsrnopkf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jarsrnopkf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jarsrnopkf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jarsrnopkf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jarsrnopkf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jarsrnopkf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jarsrnopkf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jarsrnopkf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jarsrnopkf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jarsrnopkf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jarsrnopkf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jarsrnopkf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jarsrnopkf .gt_left {
  text-align: left;
}

#jarsrnopkf .gt_center {
  text-align: center;
}

#jarsrnopkf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jarsrnopkf .gt_font_normal {
  font-weight: normal;
}

#jarsrnopkf .gt_font_bold {
  font-weight: bold;
}

#jarsrnopkf .gt_font_italic {
  font-style: italic;
}

#jarsrnopkf .gt_super {
  font-size: 65%;
}

#jarsrnopkf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jarsrnopkf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jarsrnopkf .gt_indent_1 {
  text-indent: 5px;
}

#jarsrnopkf .gt_indent_2 {
  text-indent: 10px;
}

#jarsrnopkf .gt_indent_3 {
  text-indent: 15px;
}

#jarsrnopkf .gt_indent_4 {
  text-indent: 20px;
}

#jarsrnopkf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Sample size calculated by INVAR and SS</td>
    </tr></thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup">
        <span class="gt_column_spanner">Inverse variance weighting</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup">
        <span class="gt_column_spanner">Sample size wighting</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 0</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">info_scale = 2</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">379.9012</td>
<td class="gt_row gt_right">377.1732</td>
<td class="gt_row gt_right">377.7537</td>
<td class="gt_row gt_right">408.5056</td>
<td class="gt_row gt_right">405.6640</td>
<td class="gt_row gt_right">406.2689</td>
</tr>
<tr>
<td class="gt_row gt_right">759.8024</td>
<td class="gt_row gt_right">754.3463</td>
<td class="gt_row gt_right">755.5074</td>
<td class="gt_row gt_right">817.0112</td>
<td class="gt_row gt_right">811.3281</td>
<td class="gt_row gt_right">812.5379</td>
</tr>
<tr>
<td class="gt_row gt_right">1139.7036</td>
<td class="gt_row gt_right">1131.5195</td>
<td class="gt_row gt_right">1133.2611</td>
<td class="gt_row gt_right">1225.5168</td>
<td class="gt_row gt_right">1216.9921</td>
<td class="gt_row gt_right">1218.8068</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level4">
<h4 id="simulations-1">Simulations<a class="anchor" aria-label="anchor" href="#simulations-1"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">weight_method</span>, <span class="va">n_sim</span>, <span class="va">prevalence_ratio</span>, <span class="va">IF</span>, <span class="va">under_H0</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">integration</span> <span class="op">=</span> <span class="st">"gs_power_npe"</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">ans</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span>  <span class="va">N_S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">prevalence_ratio</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prevalence_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">IF</span></span>
<span>  <span class="va">N_S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">prevalence_ratio</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prevalence_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">IF</span> </span>
<span>  <span class="va">N_S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">prevalence_ratio</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prevalence_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">IF</span> </span>
<span>  </span>
<span>  <span class="co"># begin the simulations</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">simu</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># set the random seed</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">simu</span><span class="op">)</span></span>
<span>  </span>
<span>    <span class="co"># observations of 3 strata in FA</span></span>
<span>    <span class="va">x_e_S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_e</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">x_e_S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_e</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">x_e_S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_e</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">x_c_S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_c</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">x_c_S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_c</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">x_c_S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">N_S3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p_c</span><span class="op">$</span><span class="va">Rate</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># calculate the number of events at FA</span></span>
<span>    <span class="va">n_e_S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_e_S1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_e_S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_e_S2</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_e_S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_e_S3</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_c_S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_c_S1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_c_S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_c_S2</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_c_S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x_c_S3</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># calculate the events rates</span></span>
<span>    <span class="va">p_e_S1</span> <span class="op">&lt;-</span> <span class="va">n_e_S1</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">p_e_S2</span> <span class="op">&lt;-</span> <span class="va">n_e_S2</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">p_e_S3</span> <span class="op">&lt;-</span> <span class="va">n_e_S3</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">p_c_S1</span> <span class="op">&lt;-</span> <span class="va">n_c_S1</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">p_c_S2</span> <span class="op">&lt;-</span> <span class="va">n_c_S2</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">p_c_S3</span> <span class="op">&lt;-</span> <span class="va">n_c_S3</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_S3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>    <span class="co"># calculate the variance per stratum per analysis</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                        statum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                        IF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">IF</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                        N_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N_S1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">N_S2</span><span class="op">/</span><span class="fl">2</span>, <span class="va">N_S3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                        N_c <span class="op">=</span> <span class="va">N_e</span>,</span>
<span>                        n_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_e_S1</span>, <span class="va">n_e_S2</span>, <span class="va">n_e_S3</span><span class="op">)</span>,</span>
<span>                        n_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n_c_S1</span>, <span class="va">n_c_S2</span>, <span class="va">n_c_S3</span><span class="op">)</span>,</span>
<span>                        p_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_e_S1</span>, <span class="va">p_e_S2</span>, <span class="va">p_e_S3</span><span class="op">)</span>,</span>
<span>                        p_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_c_S1</span>, <span class="va">p_c_S2</span>, <span class="va">p_c_S3</span><span class="op">)</span></span>
<span>                        <span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p_pool <span class="op">=</span> <span class="op">(</span><span class="va">n_c</span> <span class="op">+</span> <span class="va">n_e</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">N_e</span><span class="op">)</span>,</span>
<span>             sigma_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_pool</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">N_c</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             sigma_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_c</span><span class="op">)</span> <span class="op">/</span> <span class="va">N_c</span> <span class="op">+</span> <span class="va">p_e</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span> <span class="op">/</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co"># calculate the sum of weights</span></span>
<span>    <span class="va">sum_weight</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>sum_invar_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">sigma_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                sum_invar_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">sigma_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                sum_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">N_c</span> <span class="op">*</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">N_e</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="co"># calculate the weight per stratum</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sum_weight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weight_invar_H0 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sigma_H0</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sum_invar_H0</span>,</span>
<span>            weight_invar_H1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sigma_H1</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sum_invar_H1</span>,</span>
<span>            weight_ss <span class="op">=</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">*</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">N_e</span><span class="op">)</span> <span class="op">/</span> <span class="va">sum_ss</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sum_invar_H0</span>, <span class="va">sum_invar_H1</span>, <span class="va">sum_ss</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="co"># calculated the weighted rd and info</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="co"># weighted risk difference</span></span>
<span>                rd_invar_H0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                rd_invar_H1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                rd_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p_c</span> <span class="op">-</span> <span class="va">p_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                rd0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                <span class="co"># weighted statistical information under H1</span></span>
<span>                info_invar_H0 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>                info_invar_H1 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>                info_ss       <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span>      <span class="op">*</span><span class="va">p_c</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_c</span><span class="op">)</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span>      <span class="op">*</span><span class="va">p_e</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_e</span><span class="op">)</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span>,</span>
<span>                <span class="co"># weighted statistical information under H0</span></span>
<span>                info0_invar_H0 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H0</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                info0_invar_H1 <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_invar_H1</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                info0_ss       <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_ss</span><span class="op">^</span><span class="fl">2</span>      <span class="op">*</span><span class="va">p_pool</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_pool</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">N_c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">N_e</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># calculate the power</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">integration</span> <span class="op">==</span> <span class="st">"gs_power_npe"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span> <span class="op">(</span><span class="va">weight_method</span>,</span>
<span>      <span class="st">"invar_H0"</span> <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H0</span>, </span>
<span>                     info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H0</span>, </span>
<span>                     info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                     binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     lower <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>                     lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                     tol <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>                    <span class="op">)</span></span>
<span>      <span class="op">}</span>,</span>
<span>      <span class="st">"invar_H1"</span> <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span>, </span>
<span>                     info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span>, </span>
<span>                     info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                     binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     lower <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>                     lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                     tol <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>                   <span class="op">)</span> </span>
<span>      <span class="op">}</span>,</span>
<span>      <span class="st">"ss"</span> <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/gs_power_npe.html">gs_power_npe</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_ss</span>, </span>
<span>                     info <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">info_ss</span>, </span>
<span>                     info_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                     binding <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     upper <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     lower <span class="op">=</span> <span class="va">gs_b</span>, </span>
<span>                     upar <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>                     lpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     test_upper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     test_lower <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     r <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                     tol <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>                     <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">ans_new</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>simu_ID <span class="op">=</span> <span class="va">simu</span>, method <span class="op">=</span> <span class="va">weight_method</span>,</span>
<span>                                power <span class="op">=</span> <span class="va">res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Bound</span> <span class="op">==</span> <span class="st">"Upper"</span>, <span class="va">Analysis</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Probability</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">integration</span> <span class="op">==</span> <span class="st">"pmvtnorm"</span><span class="op">)</span><span class="op">{</span></span>
<span>      </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">weight_method</span> <span class="op">==</span> <span class="st">"invar_H0"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">under_H0</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>          <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H0</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>            <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">weight_method</span> <span class="op">==</span> <span class="st">"invar_H1"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">under_H0</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>          <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info0_invar_H1</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>            <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_invar_H1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info_invar_H1</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">weight_method</span> <span class="op">==</span> <span class="st">"ss"</span><span class="op">)</span><span class="op">{</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">under_H0</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>          <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_ss</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info0_ss</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="va">IF_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">info_ss</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">info_ss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>            <span class="va">mean_sim</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">rd_ss</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">info_ss</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/pmvnorm.html" class="external-link">pmvnorm</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   upper <span class="op">=</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">1</span>, sfu <span class="op">=</span> <span class="va">sfLDOF</span>, sfupar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>                   mean <span class="op">=</span> <span class="va">mean_sim</span>,</span>
<span>                   corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,                         <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>,                         <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">IF_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                               nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                   sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                   algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/algorithms.html" class="external-link">GenzBretz</a></span><span class="op">(</span>maxpts <span class="op">=</span> <span class="fl">1e5</span>, abseps <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span>, keepAttr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># summarize this simulation</span></span>
<span>      <span class="va">ans_new</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>simu_ID <span class="op">=</span> <span class="va">simu</span>, method <span class="op">=</span> <span class="va">weight_method</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ans</span>, <span class="va">ans_new</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">simu</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>n_sim &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>run simulations</span>
<span id="cb28-3"><a href="#cb28-3"></a>ans_H0 &lt;-<span class="st"> </span><span class="kw">do.call</span>(cbind,</span>
<span id="cb28-4"><a href="#cb28-4"></a>                  <span class="kw">lapply</span>(<span class="kw">list</span>(<span class="kw">list</span>(<span class="st">"ss_H0"</span>, ans<span class="op">$</span>SS0),</span>
<span id="cb28-5"><a href="#cb28-5"></a>                              <span class="kw">list</span>(<span class="st">"invar_H0"</span>, ans<span class="op">$</span>INVAR0)),</span>
<span id="cb28-6"><a href="#cb28-6"></a>                         <span class="cf">function</span>(x){<span class="kw">return</span>(<span class="kw">run_simulation</span>(<span class="dt">N =</span> x[[<span class="dv">2</span>]],</span>
<span id="cb28-7"><a href="#cb28-7"></a>                                                           <span class="dt">weight_method =</span> x[[<span class="dv">1</span>]],</span>
<span id="cb28-8"><a href="#cb28-8"></a>                                                           <span class="dt">n_sim =</span> n_sim, <span class="dt">prevalence_ratio =</span> prevalence_ratio,</span>
<span id="cb28-9"><a href="#cb28-9"></a>                                                           <span class="dt">IF =</span> IF, <span class="dt">under_H0 =</span> <span class="ot">TRUE</span>, <span class="dt">integration =</span> <span class="st">"gs_power_npe"</span>))}))</span>
<span id="cb28-10"><a href="#cb28-10"></a></span>
<span id="cb28-11"><a href="#cb28-11"></a>ans_H1 &lt;-<span class="st"> </span><span class="kw">do.call</span>(cbind,</span>
<span id="cb28-12"><a href="#cb28-12"></a>                  <span class="kw">lapply</span>(<span class="kw">list</span>(<span class="kw">list</span>(<span class="st">"ss_H1"</span>, ans<span class="op">$</span>SS1),</span>
<span id="cb28-13"><a href="#cb28-13"></a>                              <span class="kw">list</span>(<span class="st">"invar_H1"</span>, ans<span class="op">$</span>INVAR1)),</span>
<span id="cb28-14"><a href="#cb28-14"></a>                         <span class="cf">function</span>(x){<span class="kw">return</span>(<span class="kw">run_simulation</span>(<span class="dt">N =</span> x[[<span class="dv">2</span>]],</span>
<span id="cb28-15"><a href="#cb28-15"></a>                                                           <span class="dt">weight_method =</span> x[[<span class="dv">1</span>]],</span>
<span id="cb28-16"><a href="#cb28-16"></a>                                                           <span class="dt">n_sim =</span> n_sim, <span class="dt">prevalence_ratio =</span> prevalence_ratio,</span>
<span id="cb28-17"><a href="#cb28-17"></a>                                                           <span class="dt">IF =</span> IF, <span class="dt">under_H0 =</span> <span class="ot">FALSE</span>, <span class="dt">integration =</span> <span class="st">"gs_power_npe"</span>))}))</span>
<span id="cb28-18"><a href="#cb28-18"></a></span>
<span id="cb28-19"><a href="#cb28-19"></a>ans &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">simu_ID =</span> <span class="kw">rep</span>(ans_H0<span class="op">$</span>simu_ID, <span class="dv">2</span>),</span>
<span id="cb28-20"><a href="#cb28-20"></a>                      <span class="dt">ss =</span> <span class="kw">c</span>(ans_H0[, <span class="dv">3</span>], ans_H1[, <span class="dv">3</span>]), </span>
<span id="cb28-21"><a href="#cb28-21"></a>                      <span class="dt">invar =</span> <span class="kw">c</span>(ans_H0[, <span class="dv">6</span>], ans_H1[, <span class="dv">6</span>]),</span>
<span id="cb28-22"><a href="#cb28-22"></a>                      <span class="st">`</span><span class="dt">calculated under</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"H0"</span>, n_sim), <span class="kw">rep</span>(<span class="st">"H1"</span>, n_sim))) </span>
<span id="cb28-23"><a href="#cb28-23"></a></span>
<span id="cb28-24"><a href="#cb28-24"></a><span class="kw">save</span>(ans, <span class="dt">file =</span> <span class="st">"./fixtures/rd_simu_power_gspowernpe_2_weight.Rdata"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"./fixtures/rd_simu_power_gspowernpe_2_weight.Rdata"</span><span class="op">)</span></span>
<span><span class="va">ans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">`calculated under`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>`simulated power - ss` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>, </span>
<span>            `simulated power - invar` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">invar</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated power under different weightin methods"</span>,</span>
<span>                 subtitle <span class="op">=</span> <span class="st">"by gs_power_npe"</span><span class="op">)</span></span></code></pre></div>
<div id="fmuhxlrfli" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fmuhxlrfli .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fmuhxlrfli .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmuhxlrfli .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fmuhxlrfli .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fmuhxlrfli .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmuhxlrfli .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmuhxlrfli .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fmuhxlrfli .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fmuhxlrfli .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fmuhxlrfli .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fmuhxlrfli .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fmuhxlrfli .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fmuhxlrfli .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fmuhxlrfli .gt_from_md > :first-child {
  margin-top: 0;
}

#fmuhxlrfli .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fmuhxlrfli .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fmuhxlrfli .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fmuhxlrfli .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fmuhxlrfli .gt_row_group_first td {
  border-top-width: 2px;
}

#fmuhxlrfli .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmuhxlrfli .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fmuhxlrfli .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fmuhxlrfli .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmuhxlrfli .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmuhxlrfli .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fmuhxlrfli .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fmuhxlrfli .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmuhxlrfli .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmuhxlrfli .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmuhxlrfli .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmuhxlrfli .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmuhxlrfli .gt_left {
  text-align: left;
}

#fmuhxlrfli .gt_center {
  text-align: center;
}

#fmuhxlrfli .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fmuhxlrfli .gt_font_normal {
  font-weight: normal;
}

#fmuhxlrfli .gt_font_bold {
  font-weight: bold;
}

#fmuhxlrfli .gt_font_italic {
  font-style: italic;
}

#fmuhxlrfli .gt_super {
  font-size: 65%;
}

#fmuhxlrfli .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#fmuhxlrfli .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fmuhxlrfli .gt_indent_1 {
  text-indent: 5px;
}

#fmuhxlrfli .gt_indent_2 {
  text-indent: 10px;
}

#fmuhxlrfli .gt_indent_3 {
  text-indent: 15px;
}

#fmuhxlrfli .gt_indent_4 {
  text-indent: 20px;
}

#fmuhxlrfli .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<td colspan="3" class="gt_heading gt_title gt_font_normal" style>Simulated power under different weightin methods</td>
    </tr>
<tr>
<td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>by gs_power_npe</td>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">calculated under</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">simulated power - ss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">simulated power - invar</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">H0</td>
<td class="gt_row gt_right">0.7845203</td>
<td class="gt_row gt_right">0.7502050</td>
</tr>
<tr>
<td class="gt_row gt_left">H1</td>
<td class="gt_row gt_right">0.7812382</td>
<td class="gt_row gt_right">0.7503223</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary-2">Summary<a class="anchor" aria-label="anchor" href="#summary-2"></a>
</h2>
<table style="width:99%;" class="table">
<colgroup>
<col width="41%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="left">Parameters</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong><em>risk difference:</em></strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\widehat\delta _{H_0,k} = \sum_{s=1}^S w _{k,s} \delta_{k,s}^{null}\)</span></td>
<td align="left">
<p><span class="math inline">\(\delta_{k,s}^{null}\)</span> is the risk difference under <span class="math inline">\(H_0\)</span>.</p>
<p>It is 0, positive, and negative for superiority, super-superiority and non-inferiority design, respectively.</p>
</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\widehat \delta_{H_1,k} =\sum_{s=1}^S w_{k,s} (p_{C,k,s} -\widehat p_{E,k,s})\)</span></td>
<td align="left"><span class="math inline">\(\widehat p_{C,k,s} = \frac{ x _{C,k,s}}{N_{C,k,s}}, \; \widehat p_{ E,k,s} = \frac{x_{E,k,s} }{N_{E,k,s}}\)</span></td>
</tr>
<tr class="even">
<td align="left"><strong><em>standardized treatment effect:</em></strong></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\widehat\theta_{H_0,k}  = \frac{\sum_{s=1}^S  w_{k,s}\delta_{s,k}^{null}} {\sqrt { \sum_{s=1}^S w_{k,s}^2 \widehat \sigma _{H_0,k,s}^2}}\)</span></td>
<td align="left">
<p>For superiority design, <span class="math inline">\(\widehat \sigma^2_{H_0,k,s} = \widehat p _{k,s}^{pool} \left(1 - \widehat p ^{pool}_{k,s} \right) \left( \frac{1}{N_{C,k,s}} + \frac{1}{N_{E,k,s}} \right)\)</span> <br></p>
<p>For super-superiority design and non-inferiority design, <span class="math inline">\(\hat \sigma^2 _{H_0,k,s} = \frac {\widehat p _{C0,k,s}(1- \widehat p_{C0,k,s})}{N_ {C,k,s}} + \frac{ \widehat p_{E0,k,s} (1 - \widehat p_{E0,k,s})}{N_{E,k,s}}\)</span></p>
</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\widehat\theta_{H_1 ,k}  = \frac{\sum_{s=1}^S w_{k ,s} (\widehat p_{C,k,s} - \widehat p_{E,k,s})}{\sqrt {\sum_{s=1}^S w_{k,s}^2 \widehat \sigma_{H_1,k,s}^2}}\)</span></td>
<td align="left"><span class="math inline">\(\widehat \sigma_{H_1,k,s}  = \sqrt{\frac{\widehat p_{C,k,s}  (1- \widehat p_{C,k,s})}{ N_{C,k,s}} + \frac{\widehat p_{E,k,s} (1 - \widehat p_{E,k,s})}{N_{E,k,s}}}\)</span></td>
</tr>
<tr class="odd">
<td align="left"><strong><em>statistical information:</em></strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\widehat{\mathcal I} _{H_0,k} = \left\{ \begin {array}{ll} \left[ \sum_{ s=1}^S w_{k,s}^2 \frac{p_ { k,s}^{pool} (1 - p_{k,s}^{ pool})}{N_{k,s}}\right]^{-1} &amp; \text{for superiority
design
} \\ \left[ \sum_{s=1 }^S w _{k,s}^2 \frac{\bar p_{C0,s} (1 - \bar p_{C0,s})} {N _{C,s}} + w_{k,s}^2 \frac{ \bar p_{E0,s} (1 - \bar p _{E0,s})}{N_{E,s}} \right] ^{-1} &amp; \text{for
super-superiority and
non-inferiority design} \end{array} \right.\)</span></td>
<td align="left">
<span class="math inline">\(N_{k,s} = N_{C,k,s} + N_{E,k,s}\)</span> and <span class="math inline">\(\widehat p_{k,s } = (x_{C,k,s} + x_{E,k,s}) / N_{k,s}\)</span>
</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\widehat{ \mathcal I}_{H_1,k} = \left[ \sum_{s=1}^S w_{k,s}^2 \frac {\widehat p_{C,k,s} (1 - \widehat p_{C,k,s})}{N_{C,k, s}} + \sum_{s=1} ^S w _{k,s}^2 \frac{\widehat p _{E,k,s} (1 - \widehat p _{E,k,s})}{N_{E,k,s}} \right]^{-1}\)</span></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-FarringtonManning">
<p>Farrington, Conor P, and Godfrey Manning. 1990. “Test Statistics and Sample Size Formulae for Comparative Binomial Trials with Null Hypothesis of Non-Zero Risk Difference or Non-Unity Relative Risk.” <em>Statistics in Medicine</em> 9 (12): 1447–54.</p>
</div>
<div id="ref-FTU">
<p>Fleiss, Joseph L, Alex Tytun, and Hans K Ury. 1980. “A Simple Approximation for Calculating Sample Sizes for Comparing Independent Proportions.” <em>Biometrics</em>, 343–46.</p>
</div>
<div id="ref-Lachin1981">
<p>Lachin, John M. 1981. “Introduction to Sample Size Determination and Power Analysis for Clinical Trials.” <em>Controlled Clinical Trials</em> 2 (2): 93–113.</p>
</div>
<div id="ref-LachinBook">
<p>———. 2009. <em>Biostatistical Methods: The Assessment of Relative Risks</em>. Vol. 509. John Wiley &amp; Sons.</p>
</div>
<div id="ref-MantelHaenszel">
<p>Mantel, Nathan, and William Haenszel. 1959. “Statistical Aspects of the Analysis of Data from Retrospective Studies of Disease.” <em>Journal of the National Cancer Institute</em> 22 (4): 719–48.</p>
</div>
<div id="ref-Mehrotra2000">
<p>Mehrotra, Devan V, and Radha Railkar. 2000a. “Minimum Risk Weights for Comparing Treatments in Stratified Binomial Trials.” <em>Statistics in Medicine</em> 19 (6): 811–25.</p>
</div>
<div id="ref-mehrotra2000minimum">
<p>———. 2000b. “Minimum Risk Weights for Comparing Treatments in Stratified Binomial Trials.” <em>Statistics in Medicine</em> 19 (6): 811–25.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keaven Anderson, Yilong Zhang, Yujie Zhao. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6. <br>Copyright © 2022 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><span></span></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
